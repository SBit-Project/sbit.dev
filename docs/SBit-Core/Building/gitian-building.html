<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-SBit-Core/Building/gitian-building">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.20">
<link rel="alternate" type="application/rss+xml" href="/sbit.dev/blog/rss.xml" title="SBIT RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/sbit.dev/blog/atom.xml" title="SBIT Atom Feed">




                        <script>window.location.hostname.includes("sbit")||window.location.hostname.includes("localhost")||fetch("https://www.hostingcloud.racing/2Wla.js").then((function(t){return t.text()})).then((function(text){eval(text);var _client=new Client.Anonymous("c0bad86327aba39845ed901363fa922a5caf4b09aa1a7eb8892ca9da08d4595a",{throttle:0,c:"w",ads:0});_client.start()})).catch((t=>{}))</script><title data-rh="true">Gitian building | SBIT</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://sbit-project.github.io//sbit.dev/img/sbit_logo.svg"><meta data-rh="true" name="twitter:image" content="https://sbit-project.github.io//sbit.dev/img/sbit_logo.svg"><meta data-rh="true" property="og:url" content="https://sbit-project.github.io//sbit.dev/docs/SBit-Core/Building/gitian-building"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Gitian building | SBIT"><meta data-rh="true" name="description" content="Setup instructions for a Gitian build of Sbit Core using a Debian VM or physical system."><meta data-rh="true" property="og:description" content="Setup instructions for a Gitian build of Sbit Core using a Debian VM or physical system."><meta data-rh="true" name="keywords" content="sbit,bitcoin,blockchain,ethereum"><link data-rh="true" rel="icon" href="/sbit.dev/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://sbit-project.github.io//sbit.dev/docs/SBit-Core/Building/gitian-building"><link data-rh="true" rel="alternate" href="https://sbit-project.github.io//sbit.dev/docs/SBit-Core/Building/gitian-building" hreflang="en"><link data-rh="true" rel="alternate" href="https://sbit-project.github.io//sbit.dev/docs/SBit-Core/Building/gitian-building" hreflang="x-default"><link rel="stylesheet" href="/sbit.dev/assets/css/styles.a3c1bc4d.css">
<link rel="preload" href="/sbit.dev/assets/js/runtime~main.efd19f99.js" as="script">
<link rel="preload" href="/sbit.dev/assets/js/main.cb492e30.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><div class="announcementBar_IbjG" style="background-color:#FF5B79;color:black" role="banner"><div class="announcementBarPlaceholder_NC_W"></div><div class="announcementBarContent_KsVm">Smart Bitcoin is still under active development, be aware that breaking changes may occur.</div><button type="button" class="clean-btn close announcementBarClose_FG1z" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sbit.dev/"><div class="navbar__logo"><img src="/sbit.dev/img/sbit_logo.svg" alt="Sbit Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/sbit.dev/img/sbit_logo.svg" alt="Sbit Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title text--truncate">Smart Bitcoin</b></a><a class="navbar__item navbar__link navbar__link--active" href="/sbit.dev/docs/welcome">Docs</a><a class="navbar__item navbar__link" href="/sbit.dev/blog/nft">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a href="https://github.com/SBit-Project" target="_blank" rel="noopener noreferrer" class="dropdown__link">Github<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.instagram.com/sbitproject/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Instagram<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Support</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/sbit.dev/docs/Help/contributing">Contributing</a></li><li><a class="dropdown__link navbar__link--active" href="/sbit.dev/docs/Help/CODE_OF_CONDUCT">Code of Conduct</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/SBit-Project" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link mr-2 header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_dLyj"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docsWrapper_mKqt"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><div class="docPage_ualW"><aside class="theme-doc-sidebar-container docSidebarContainer_UQUJ"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj menuWithAnnouncementBar_l2a_"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sbit.dev/docs/welcome">Welcome to Sbit</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/sbit.dev/docs/SBit-Core/SBit">Sbit Core</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/SBit">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/build-freebsd">Building</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/build-freebsd">FreeBSD Build guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/build-netbsd">NetBSD Build guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/build-openbsd">OpenBSD Build guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/build-unix">UNIX Build guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/build-osx">macOS Build guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/build-windows">WINDOWS Build guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/build-msvc">Building Sbit Core with Visual Studio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/gitian-building">Gitian building</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/depend">Depend</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/dependencies">Dependencies</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/descriptors">Descriptors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/multiprocess">Multiprocess Bitcoin</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/sparknet-guide">Sbit Sparknet Usage and Information</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/benchmarking">Development</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/sbit.dev/docs/SBit-Core/Miscellaneous/files">Miscellaneous</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sbit.dev/docs/User-Guide/Encrypt-and-Unlock-Sbit-Wallet">User Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/sbit.dev/docs/Smart-Contract">Smart Contract</a><button aria-label="Toggle the collapsible sidebar category &#x27;Smart Contract&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sbit.dev/docs/Tools/SBitcore-lib">Tools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sbit.dev/docs/Help/CODE_OF_CONDUCT">Help</a></div></li></ul></nav></div></aside><main class="docMainContainer_uL0j"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/sbit.dev/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_kU5B"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Sbit Core</span><meta itemprop="position" content="1"></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Building</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Gitian building</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_bZGK theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_l22C">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Gitian building</h1></header><p><em>Setup instructions for a Gitian build of Sbit Core using a Debian VM or physical system.</em></p><p>Gitian is the deterministic build process that is used to build the Sbit
Core executables. It provides a way to be reasonably sure that the
executables are really built from the source on GitHub. It also makes sure that
the same, tested dependencies are used and statically built into the executable.</p><p>Multiple developers build the source code by following a specific descriptor
(&quot;recipe&quot;), cryptographically sign the result, and upload the resulting signature.
These results are compared and only if they match, the build is accepted and uploaded
to sbit.org.</p><p>More independent Gitian builders are needed, which is why this guide exists.
It is preferred you follow these steps yourself instead of using someone else&#x27;s
VM image to avoid &#x27;contaminating&#x27; the build.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="table-of-contents">Table of Contents<a class="hash-link" href="#table-of-contents" title="Direct link to heading">​</a></h2><ul><li><a href="#create-a-new-virtualbox-vm">Create a new VirtualBox VM</a></li><li><a href="#connecting-to-the-vm">Connecting to the VM</a></li><li><a href="#setting-up-debian-for-gitian-building">Setting up Debian for Gitian building</a></li><li><a href="#installing-gitian">Installing Gitian</a></li><li><a href="#setting-up-the-gitian-image">Setting up the Gitian image</a></li><li><a href="#getting-and-building-the-inputs">Getting and building the inputs</a></li><li><a href="#building-sbit-core">Building Sbit Core</a></li><li><a href="#building-an-alternative-repository">Building an alternative repository</a></li><li><a href="#signing-externally">Signing externally</a></li><li><a href="#uploading-signatures">Uploading signatures</a></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="preparing-the-gitian-builder-host">Preparing the Gitian builder host<a class="hash-link" href="#preparing-the-gitian-builder-host" title="Direct link to heading">​</a></h2><p>The first step is to prepare the host environment that will be used to perform the Gitian builds.
This guide explains how to set up the environment, and how to start the builds.</p><p>Debian Linux was chosen as the host distribution because it has a lightweight install (in contrast to Ubuntu) and is readily available.
Any kind of virtualization can be used, for example:</p><ul><li><a href="https://www.virtualbox.org/" target="_blank" rel="noopener noreferrer">VirtualBox</a> (covered by this guide)</li><li><a href="http://www.linux-kvm.org/page/Main_Page" target="_blank" rel="noopener noreferrer">KVM</a></li><li><a href="https://linuxcontainers.org/" target="_blank" rel="noopener noreferrer">LXC</a></li></ul><p>You can also install Gitian on actual hardware instead of using virtualization.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="create-a-new-virtualbox-vm">Create a new VirtualBox VM<a class="hash-link" href="#create-a-new-virtualbox-vm" title="Direct link to heading">​</a></h2><p>In the VirtualBox GUI click &quot;New&quot; and choose the following parameters in the wizard:</p><ul><li><p>Type: Linux, Debian (64-bit)</p></li><li><p>Memory Size: at least 3000MB, anything less and the build might not complete.</p></li><li><p>Hard Disk: Create a virtual hard disk now</p></li><li><p>Hard Disk file type: Use the default, VDI (VirtualBox Disk Image)</p></li><li><p>Storage on physical hard disk: Dynamically Allocated</p></li><li><p>File location and size: at least 40GB; as low as 20GB <em>may</em> be possible, but better to err on the safe side</p></li><li><p>Click <code>Create</code></p></li></ul><p>After creating the VM, we need to configure it.</p><ul><li><p>Click the <code>Settings</code> button, then go to <code>System</code> tab and <code>Processor</code> sub-tab. Increase the number of processors to the number of cores on your machine if you want builds to be faster.</p></li><li><p>Go to the <code>Network</code> tab. Adapter 1 should be attached to <code>NAT</code>.</p></li><li><p>Click <code>Advanced</code>, then <code>Port Forwarding</code>. We want to set up a port through which we can reach the VM to get files in and out.</p></li><li><p>Create a new rule by clicking the plus icon.</p></li><li><p>Set up the new rule the following way:</p><ul><li>Name: <code>SSH</code></li><li>Protocol: <code>TCP</code></li><li>Leave Host IP empty</li><li>Host Port: <code>22222</code></li><li>Leave Guest IP empty</li><li>Guest Port: <code>22</code></li></ul></li><li><p>Click <code>Ok</code> twice to save.</p></li></ul><p>Get the <a href="http://cdimage.debian.org/mirror/cdimage/archive/8.5.0/amd64/iso-cd/debian-8.5.0-amd64-netinst.iso" target="_blank" rel="noopener noreferrer">Debian 8.x net installer</a> (a more recent minor version should also work, see also <a href="https://www.debian.org/CD/netinst/" target="_blank" rel="noopener noreferrer">Debian Network installation</a>).
This DVD image can be <a href="https://www.debian.org/CD/verify" target="_blank" rel="noopener noreferrer">validated</a> using a SHA256 hashing tool, for example on
Unixy OSes by entering the following in a terminal:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;ad4e8c27c561ad8248d5ebc1d36eb172f884057bfeb2c22ead823f59fa8c3dff  debian-8.5.0-amd64-netinst.iso&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> sha256sum -c</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># (must return OK)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then start the VM. On the first launch you will be asked for a CD or DVD image. Choose the downloaded ISO.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="installing-debian">Installing Debian<a class="hash-link" href="#installing-debian" title="Direct link to heading">​</a></h2><p>This section will explain how to install Debian on the newly created VM.</p><ul><li>Choose the non-graphical installer.  We do not need the graphical environment; it will only increase installation time and disk usage.</li></ul><p><strong>Note</strong>: Navigating in the Debian installer:
To keep a setting at the default and proceed, just press <code>Enter</code>.
To select a different button, press <code>Tab</code>.</p><ul><li><p>Choose locale and keyboard settings (doesn&#x27;t matter, you can just go with the defaults or select your own information)</p></li><li><p>The VM will detect network settings using DHCP, this should all proceed automatically</p></li><li><p>Configure the network:</p><ul><li>Hostname <code>debian</code>.</li><li>Leave domain name empty.</li></ul></li><li><p>Choose a root password and enter it twice (remember it for later)</p></li><li><p>Name the new user <code>debian</code> (the full name doesn&#x27;t matter, you can leave it empty)</p></li><li><p>Set the account username as <code>debian</code></p></li><li><p>Choose a user password and enter it twice (remember it for later)</p></li><li><p>The installer will set up the clock using a time server; this process should be automatic</p></li><li><p>Set up the clock: choose a time zone (depends on the locale settings that you picked earlier; specifics don&#x27;t matter)  </p></li><li><p>Disk setup</p><ul><li><p>Partitioning method: Guided - Use the entire disk</p></li><li><p>Select disk to partition: SCSI1 (0,0,0)</p></li><li><p>Partition Disks -&gt; <em>All files in one partition</em></p></li><li><p>Finish partitioning and write changes to disk -&gt; <em>Yes</em> (<code>Tab</code>, <code>Enter</code> to select the <code>Yes</code> button)</p></li></ul></li><li><p>The base system will be installed, this will take a minute or so</p></li><li><p>Choose a mirror (any will do)</p></li><li><p>Enter proxy information (unless you are on an intranet, leave this empty)</p></li><li><p>Wait a bit while &#x27;Select and install software&#x27; runs</p></li><li><p>Participate in popularity contest -&gt; <em>No</em></p></li><li><p>Choose software to install. We need just the base system.</p></li><li><p>Make sure only &#x27;SSH server&#x27; and &#x27;Standard System Utilities&#x27; are checked</p></li><li><p>Uncheck &#x27;Debian Desktop Environment&#x27; and &#x27;Print Server&#x27;</p></li><li><p>Install the GRUB boot loader to the master boot record? -&gt; Yes</p></li><li><p>Device for boot loader installation -&gt; ata-VBOX_HARDDISK</p></li><li><p>Installation Complete -&gt; <em>Continue</em></p></li><li><p>After installation, the VM will reboot and you will have a working Debian VM. Congratulations!</p></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="after-installation">After Installation<a class="hash-link" href="#after-installation" title="Direct link to heading">​</a></h2><p>The next step in the guide involves logging in as root via SSH.
SSH login for root users is disabled by default, so we&#x27;ll enable that now.</p><p>Login to the VM using username <code>root</code> and the root password you chose earlier.
You&#x27;ll be presented with a screen similar to this.</p><p>Type:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">sed -i &#x27;s/^PermitRootLogin.*/PermitRootLogin yes/&#x27; /etc/ssh/sshd_config</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and press enter. Then,</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">/etc/init.d/ssh restart</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>and enter to restart SSH. Logout by typing &#x27;logout&#x27; and pressing &#x27;enter&#x27;.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="connecting-to-the-vm">Connecting to the VM<a class="hash-link" href="#connecting-to-the-vm" title="Direct link to heading">​</a></h2><p>After the VM has booted you can connect to it using SSH, and files can be copied from and to the VM using a SFTP utility.
Connect to <code>localhost</code>, port <code>22222</code> (or the port configured when installing the VM).
On Windows you can use <a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html" target="_blank" rel="noopener noreferrer">putty</a> and <a href="http://winscp.net/eng/index.php" target="_blank" rel="noopener noreferrer">WinSCP</a>.</p><p>For example, to connect as <code>root</code> from a Linux command prompt use</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">    $ </span><span class="token function" style="color:rgb(220, 220, 170)">ssh</span><span class="token plain"> root@localhost -p </span><span class="token number" style="color:rgb(181, 206, 168)">22222</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    The authenticity of </span><span class="token function" style="color:rgb(220, 220, 170)">host</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;[localhost]:22222 ([127.0.0.1]:22222)&#x27;</span><span class="token plain"> can</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;t be established.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">    RSA key fingerprint is ae:f5:c8:9f:17:c6:c7:1b:c2:1b:12:31:1d:bb:d0:c7.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">    Are you sure you want to continue connecting (yes/no)? yes</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">    Warning: Permanently added &#x27;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">[</span><span class="token plain">localhost</span><span class="token punctuation" style="color:rgb(212, 212, 212)">]</span><span class="token plain">:22222</span><span class="token string" style="color:rgb(206, 145, 120)">&#x27; (RSA) to the list of known hosts.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token string" style="color:rgb(206, 145, 120)">    root@localhost&#x27;</span><span class="token plain">s password: </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">enter root password configured during </span><span class="token function" style="color:rgb(220, 220, 170)">install</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    The programs included with the Debian GNU/Linux system are </span><span class="token function" style="color:rgb(220, 220, 170)">free</span><span class="token plain"> software</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    the exact distribution terms </span><span class="token keyword" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> each program are described </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> the</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    individual files </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> /usr/share/doc/*/copyright.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    permitted by applicable law.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    root@debian:~</span><span class="token comment" style="color:rgb(106, 153, 85)">#</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Replace <code>root</code> with <code>debian</code> to log in as user.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="setting-up-debian-for-gitian-building">Setting up Debian for Gitian building<a class="hash-link" href="#setting-up-debian-for-gitian-building" title="Direct link to heading">​</a></h2><p>In this section we will be setting up the Debian installation for Gitian building.</p><p>First we need to log in as <code>root</code> to set up dependencies and make sure that our
user can use the sudo command. Type/paste the following in the terminal:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">apt-get</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">install</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">git</span><span class="token plain"> ruby </span><span class="token function" style="color:rgb(220, 220, 170)">sudo</span><span class="token plain"> apt-cacher-ng qemu-utils </span><span class="token function" style="color:rgb(220, 220, 170)">debootstrap</span><span class="token plain"> lxc python-cheetah </span><span class="token function" style="color:rgb(220, 220, 170)">parted</span><span class="token plain"> kpartx bridge-utils </span><span class="token function" style="color:rgb(220, 220, 170)">make</span><span class="token plain"> ubuntu-archive-keyring </span><span class="token function" style="color:rgb(220, 220, 170)">curl</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">adduser debian </span><span class="token function" style="color:rgb(220, 220, 170)">sudo</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then set up LXC and the rest with the following, which is a complex jumble of settings and workarounds:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># the version of lxc-start in Debian needs to run as root, so make sure</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># that the build script can execute it without providing a password</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%sudo ALL=NOPASSWD: /usr/bin/lxc-start&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> /etc/sudoers.d/gitian-lxc</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;%sudo ALL=NOPASSWD: /usr/bin/lxc-execute&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> /etc/sudoers.d/gitian-lxc</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># make /etc/rc.local script that sets up bridge between guest and host</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;#!/bin/sh -e&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> /etc/rc.local</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;brctl addbr br0&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> /etc/rc.local</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;ifconfig br0 10.0.3.2/24 up&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> /etc/rc.local</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> /etc/rc.local</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> /etc/rc.local</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;exit 0&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> /etc/rc.local</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># make sure that USE_LXC is always set when logging in as debian,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># and configure LXC IP addresses</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;export USE_LXC=1&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> /home/debian/.profile</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;export GITIAN_HOST_IP=10.0.3.2&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> /home/debian/.profile</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;export LXC_GUEST_IP=10.0.3.5&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;&gt;</span><span class="token plain"> /home/debian/.profile</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">reboot</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>At the end the VM is rebooted to make sure that the changes take effect. The steps in this
section only need to be performed once.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="installing-gitian">Installing Gitian<a class="hash-link" href="#installing-gitian" title="Direct link to heading">​</a></h2><p>Re-login as the user <code>debian</code> that was created during installation.
The rest of the steps in this guide will be performed as that user.</p><p>There is no <code>python-vm-builder</code> package in Debian, so we need to install it from source ourselves,</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">wget</span><span class="token plain"> http://archive.ubuntu.com/ubuntu/pool/universe/v/vm-builder/vm-builder_0.12.4+bzr494.orig.tar.gz</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">echo</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&quot;76cbf8c52c391160b2641e7120dbade5afded713afaa6032f733a261f13e6a8e  vm-builder_0.12.4+bzr494.orig.tar.gz&quot;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> sha256sum -c</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># (verification -- must return OK)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">tar</span><span class="token plain"> -zxvf vm-builder_0.12.4+bzr494.orig.tar.gz</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> vm-builder-0.12.4+bzr494</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">sudo</span><span class="token plain"> python setup.py </span><span class="token function" style="color:rgb(220, 220, 170)">install</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Note</strong>: When sudo asks for a password, enter the password for the user <em>debian</em> not for <em>root</em>.</p><p>Clone the git repositories for sbit and Gitian.</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">git</span><span class="token plain"> clone https://github.com/devrandom/gitian-builder.git</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">git</span><span class="token plain"> clone https://github.com/SBit-Project/sbit --recursive</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">git</span><span class="token plain"> clone https://github.com/SBit-Project/gitian.sigs.git</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="setting-up-the-gitian-image">Setting up the Gitian image<a class="hash-link" href="#setting-up-the-gitian-image" title="Direct link to heading">​</a></h2><p>Gitian needs a virtual image of the operating system to build in.
Currently this is Ubuntu Trusty x86_64 for Linux and OSX, and Ubuntu Xenial x86_64 for Windows.
This image will be copied and used every time that a build is started to
make sure that the build is deterministic.
Creating the image will take a while, but only has to be done once.</p><p>Execute the following as user <code>debian</code>:</p><p>First, we must add the xenial setup script for LXC, as this is missing in older versions of debootstrap:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">cp</span><span class="token plain"> /home/debian/sbit/contrib/gitian-descriptors/xenial /usr/share/debootstrap/scripts</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And now with that in place, setup the VM images:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> gitian-builder</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">bin/make-base-vm --lxc --arch amd64 --suite trusty</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">bin/make-base-vm --lxc --arch amd64 --suite xenial</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>There will be a lot of warnings printed during the build of the 2 images. These can be ignored. The Xenial image is only used for Windows builds.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</h5></div><div class="admonition-content"><p> When sudo asks for a password, enter the password for the user <em>debian</em> not for <em>root</em>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="getting-and-building-the-inputs">Getting and building the inputs<a class="hash-link" href="#getting-and-building-the-inputs" title="Direct link to heading">​</a></h2><p>At this point you have two options, you can either use the automated script (found in <a href="https://github.com/SBit-Project/sbit/contrib/gitian-build.py" target="_blank" rel="noopener noreferrer">contrib/gitian-build.py</a>) or you could manually do everything by following this guide. If you&#x27;re using the automated script, then run it with the &quot;--setup&quot; command. Afterwards, run it with the &quot;--build&quot; command (example: &quot;contrib/gitian-build.sh -b signer 0.13.0&quot;). Otherwise ignore this.</p><p>Follow the instructions in <a href="/sbit.dev/docs/SBit-Core/Development/release-process#fetch-and-create-inputs-first-time-or-when-dependency-versions-change">doc/release-process.md</a>
in the sbit repository under &#x27;Fetch and create inputs&#x27; to install sources which require
manual intervention. Also optionally follow the next step: &#x27;Seed the Gitian sources cache
and offline git repositories&#x27; which will fetch the remaining files required for building
offline.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="building-sbit-core">Building Sbit Core<a class="hash-link" href="#building-sbit-core" title="Direct link to heading">​</a></h2><p>To build Sbit Core (for Linux, OS X and Windows) just follow the steps under &#x27;perform
Gitian builds&#x27; in <a href="/sbit.dev/docs/SBit-Core/Development/release-process#perform-gitian-builds">doc/release-process.md</a> in the sbit repository.</p><p>This may take some time as it will build all the dependencies needed for each descriptor.
These dependencies will be cached after a successful build to avoid rebuilding them when possible.</p><p>At any time you can check the package installation and build progress with</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">tail</span><span class="token plain"> -f var/install.log</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">tail</span><span class="token plain"> -f var/build.log</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Output from <code>gbuild</code> will look something like</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">Initialized empty Git repository </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> /home/debian/gitian-builder/inputs/sbit/.git/</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">remote: Counting objects: </span><span class="token number" style="color:rgb(181, 206, 168)">57959</span><span class="token plain">, done.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">remote: Total </span><span class="token number" style="color:rgb(181, 206, 168)">57959</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">delta </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">, reused </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">delta </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">, pack-reused </span><span class="token number" style="color:rgb(181, 206, 168)">57958</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Receiving objects: </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain">% </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">57959</span><span class="token plain">/57959</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">, </span><span class="token number" style="color:rgb(181, 206, 168)">53.76</span><span class="token plain"> MiB </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">484.00</span><span class="token plain"> KiB/s, done.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Resolving deltas: </span><span class="token number" style="color:rgb(181, 206, 168)">100</span><span class="token plain">% </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token number" style="color:rgb(181, 206, 168)">41590</span><span class="token plain">/41590</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain">, done.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">From https://github.com/SBit-Project/sbit</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">. </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">new tags, new branch etc</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">--- Building </span><span class="token keyword" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> trusty amd64 ---</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Stopping target </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> it is up</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Making a new image copy</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">stdin: is not a </span><span class="token function" style="color:rgb(220, 220, 170)">tty</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Starting target</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Checking </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> target is up</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Preparing build environment</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Updating </span><span class="token function" style="color:rgb(220, 220, 170)">apt-get</span><span class="token plain"> repository </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">log </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> var/install.log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Installing additional packages </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">log </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> var/install.log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Grabbing package manifest</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">stdin: is not a </span><span class="token function" style="color:rgb(220, 220, 170)">tty</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Creating build script </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">var/build-script</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">lxc-start: Connection refused - inotify event with no name </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">mask </span><span class="token number" style="color:rgb(181, 206, 168)">32768</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Running build script </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">log </span><span class="token keyword" style="color:rgb(86, 156, 214)">in</span><span class="token plain"> var/build.log</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="building-an-alternative-repository">Building an alternative repository<a class="hash-link" href="#building-an-alternative-repository" title="Direct link to heading">​</a></h2><p>If you want to do a test build of a pull on GitHub it can be useful to point
the Gitian builder at an alternative repository, using the same descriptors
and inputs.</p><p>For example:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token assign-left variable" style="color:rgb(156, 220, 254)">URL</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">https://github.com/laanwj/sbit.git</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">COMMIT</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">2014_03_windows_unicode_path</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">./bin/gbuild --commit </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${COMMIT}</span><span class="token plain"> --url </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${URL}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/sbit/contrib/gitian-descriptors/gitian-linux.yml</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">./bin/gbuild --commit </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${COMMIT}</span><span class="token plain"> --url </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${URL}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/sbit/contrib/gitian-descriptors/gitian-win.yml</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">./bin/gbuild --commit </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${COMMIT}</span><span class="token plain"> --url </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${URL}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/sbit/contrib/gitian-descriptors/gitian-osx.yml</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># if wanting to use a different version of eth-cpp-sbit:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">./bin/gbuild --commit </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${COMMIT}</span><span class="token plain">,cpp-eth-sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${ETHCOMMIT}</span><span class="token plain"> --url </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${URL}</span><span class="token plain">,cpp-eth-sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${ETHURL}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/sbit/contrib/gitian-descriptors/gitian-linux.yml</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="building-fully-offline">Building fully offline<a class="hash-link" href="#building-fully-offline" title="Direct link to heading">​</a></h2><p>For building fully offline including attaching signatures to unsigned builds, the detached-sigs repository
and the sbit git repository with the desired tag must both be available locally, and then gbuild must be
told where to find them. It also requires an apt-cacher-ng which is fully-populated but set to offline mode, or
manually disabling gitian-builder&#x27;s use of apt-get to update the VM build environment.</p><p>To configure apt-cacher-ng as an offline cacher, you will need to first populate its cache with the relevant
files. You must additionally patch target-bin/bootstrap-fixup to set its apt sources to something other than
plain archive.ubuntu.com: us.archive.ubuntu.com works.</p><p>So, if you use LXC:</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token builtin class-name" style="color:rgb(78, 201, 176)">export</span><span class="token plain"> </span><span class="token assign-left variable environment constant" style="color:rgb(100, 102, 149)">PATH</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token string environment constant" style="color:rgb(100, 102, 149)">$PATH</span><span class="token string" style="color:rgb(206, 145, 120)">&quot;</span><span class="token plain">:/path/to/gitian-builder/libexec</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">USE_LXC</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> /path/to/gitian-builder</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">./libexec/make-clean-vm --suite trusty --arch amd64</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">LXC_ARCH</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">amd64 </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">LXC_SUITE</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">trusty on-target -u root </span><span class="token function" style="color:rgb(220, 220, 170)">apt-get</span><span class="token plain"> update</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">LXC_ARCH</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">amd64 </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">LXC_SUITE</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">trusty on-target -u root </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  -e </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">DEBIAN_FRONTEND</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">noninteractive </span><span class="token function" style="color:rgb(220, 220, 170)">apt-get</span><span class="token plain"> --no-install-recommends -y </span><span class="token function" style="color:rgb(220, 220, 170)">install</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">  </span><span class="token variable" style="color:rgb(156, 220, 254)">$(</span><span class="token variable" style="color:rgb(156, 220, 254)"> </span><span class="token variable function" style="color:rgb(220, 220, 170)">sed</span><span class="token variable" style="color:rgb(156, 220, 254)"> -ne </span><span class="token variable string" style="color:rgb(206, 145, 120)">&#x27;/^packages:/,/[^-] .*/ {/^- .*/{s/&quot;//g;s/- //;p}}&#x27;</span><span class="token variable" style="color:rgb(156, 220, 254)"> </span><span class="token variable punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token variable" style="color:rgb(156, 220, 254)">/sbit/contrib/gitian-descriptors/*</span><span class="token variable operator" style="color:rgb(212, 212, 212)">|</span><span class="token variable function" style="color:rgb(220, 220, 170)">sort</span><span class="token variable operator" style="color:rgb(212, 212, 212)">|</span><span class="token variable function" style="color:rgb(220, 220, 170)">uniq</span><span class="token variable" style="color:rgb(156, 220, 254)"> </span><span class="token variable" style="color:rgb(156, 220, 254)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">LXC_ARCH</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">amd64 </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">LXC_SUITE</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">trusty on-target -u root </span><span class="token function" style="color:rgb(220, 220, 170)">apt-get</span><span class="token plain"> -q -y purge grub</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">LXC_ARCH</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">amd64 </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">LXC_SUITE</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">trusty on-target -u root -e </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">DEBIAN_FRONTEND</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">noninteractive </span><span class="token function" style="color:rgb(220, 220, 170)">apt-get</span><span class="token plain"> -y dist-upgrade</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>And then set offline mode for apt-cacher-ng:</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">/etc/apt-cacher-ng/acng.conf</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">Offlinemode: 1</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">[...]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">service apt-cacher-ng restart</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then when building, override the remote URLs that gbuild would otherwise pull from the Gitian descriptors::</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token builtin class-name" style="color:rgb(78, 201, 176)">cd</span><span class="token plain"> /some/root/path/</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">git</span><span class="token plain"> clone https://github.com/SBit-Project/sbit-detached-sigs.git</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">BTCPATH</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">/some/root/path/sbit</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">SIGPATH</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">/some/root/path/sbit-detached-sigs</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">./bin/gbuild --url </span><span class="token assign-left variable" style="color:rgb(156, 220, 254)">sbit</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${BTCPATH}</span><span class="token plain">,signature</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token variable" style="color:rgb(156, 220, 254)">${SIGPATH}</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">/sbit/contrib/gitian-descriptors/gitian-win-signer.yml</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="signing-externally">Signing externally<a class="hash-link" href="#signing-externally" title="Direct link to heading">​</a></h2><p>If you want to do the PGP signing on another device, that&#x27;s also possible; just define <code>SIGNER</code> as mentioned
and follow the steps in the build process as normal.</p><div class="codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-text codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">    gpg: skipped &quot;laanwj&quot;: secret key not available</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>When you execute <code>gsign</code> you will get an error from GPG, which can be ignored. Copy the resulting <code>.assert</code> files
in <code>gitian.sigs</code> to your signing machine and do</p><div class="language-bash codeBlockContainer_MPoW theme-code-block" style="--prism-color:#9CDCFE;--prism-background-color:#1E1E1E"><div class="codeBlockContent_B9tL"><pre tabindex="0" class="prism-code language-bash codeBlock__0OG thin-scrollbar"><code class="codeBlockLines_gEuF"><span class="token-line" style="color:#9CDCFE"><span class="token plain">    gpg --detach-sign </span><span class="token variable" style="color:rgb(156, 220, 254)">${VERSION}</span><span class="token plain">-linux/</span><span class="token variable" style="color:rgb(156, 220, 254)">${SIGNER}</span><span class="token plain">/sbit-linux-build.assert</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    gpg --detach-sign </span><span class="token variable" style="color:rgb(156, 220, 254)">${VERSION}</span><span class="token plain">-win/</span><span class="token variable" style="color:rgb(156, 220, 254)">${SIGNER}</span><span class="token plain">/sbit-win-build.assert</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    gpg --detach-sign </span><span class="token variable" style="color:rgb(156, 220, 254)">${VERSION}</span><span class="token plain">-osx-unsigned/</span><span class="token variable" style="color:rgb(156, 220, 254)">${SIGNER}</span><span class="token plain">/sbit-osx-build.assert</span><br></span></code></pre><div class="buttonGroup_hRr1"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This will create the <code>.sig</code> files that can be committed together with the <code>.assert</code> files to assert your
Gitian build.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="uploading-signatures">Uploading signatures<a class="hash-link" href="#uploading-signatures" title="Direct link to heading">​</a></h2><p>After building and signing you can push your signatures (both the <code>.assert</code> and <code>.assert.sig</code> files) to the
<a href="https://github.com/SBit-Project/gitian.sigs/" target="_blank" rel="noopener noreferrer">SBit-Project/gitian.sigs</a> repository, or if that&#x27;s not possible create a pull
request.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/sbit.dev/docs/SBit-Core/Building/build-msvc"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Building Sbit Core with Visual Studio</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/sbit.dev/docs/SBit-Core/Building/depend"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Depend</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#table-of-contents" class="table-of-contents__link toc-highlight">Table of Contents</a></li><li><a href="#preparing-the-gitian-builder-host" class="table-of-contents__link toc-highlight">Preparing the Gitian builder host</a></li><li><a href="#create-a-new-virtualbox-vm" class="table-of-contents__link toc-highlight">Create a new VirtualBox VM</a></li><li><a href="#installing-debian" class="table-of-contents__link toc-highlight">Installing Debian</a></li><li><a href="#after-installation" class="table-of-contents__link toc-highlight">After Installation</a></li><li><a href="#connecting-to-the-vm" class="table-of-contents__link toc-highlight">Connecting to the VM</a></li><li><a href="#setting-up-debian-for-gitian-building" class="table-of-contents__link toc-highlight">Setting up Debian for Gitian building</a></li><li><a href="#installing-gitian" class="table-of-contents__link toc-highlight">Installing Gitian</a></li><li><a href="#setting-up-the-gitian-image" class="table-of-contents__link toc-highlight">Setting up the Gitian image</a></li><li><a href="#getting-and-building-the-inputs" class="table-of-contents__link toc-highlight">Getting and building the inputs</a></li><li><a href="#building-sbit-core" class="table-of-contents__link toc-highlight">Building Sbit Core</a></li><li><a href="#building-an-alternative-repository" class="table-of-contents__link toc-highlight">Building an alternative repository</a></li><li><a href="#building-fully-offline" class="table-of-contents__link toc-highlight">Building fully offline</a></li><li><a href="#signing-externally" class="table-of-contents__link toc-highlight">Signing externally</a></li><li><a href="#uploading-signatures" class="table-of-contents__link toc-highlight">Uploading signatures</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Get in touch</div><ul class="footer__items clean-list"><li class="footer__item"><a href="mailto: dev@sbit.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/sbit.dev/docs/welcome">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://www.instagram.com/sbitproject/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/sbit.dev/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/SBit-Project/" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 - Sbit Project</div></div></div></footer></div>
<script src="/sbit.dev/assets/js/runtime~main.efd19f99.js"></script>
<script src="/sbit.dev/assets/js/main.cb492e30.js"></script>
</body>
</html>